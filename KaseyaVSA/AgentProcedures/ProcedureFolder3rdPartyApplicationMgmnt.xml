<?xml version="1.0" encoding="utf-8"?>
<ScriptExport xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.kaseya.com/vsa/2008/12/Scripting">
  <Folder name="3rd Party Application Mgmnt 2018-12-19" treePres="3">
    <Folder name="Mac" treePres="3">
      <Folder name="Application Deployment" treePres="3">
        <Folder name="Language Independent" treePres="3">
          <Procedure name="Application Deployment - Mac OS X - Chrome - Deploy Latest" treePres="3" id="1642126526" folderId="484857764833074" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Mac.Application Deployment.Language Independent">
            <Body description="Description: Force any Skype version to be updated to latest silently. If Skype does not exist it will be deployed.&#xA;&#xA;Kaseya customer value: Procedure to secure and enhance clients with the latest software.&#xA;&#xA;End user value: Procedure to secure and enhance clients with the latest software and functions.&#xA;&#xA;Dependencies: Windows OS. The MSI package should stay in Kaseya agent working folder after deployment.&#xA;&#xA;Usage: Run at any given time. The installer will close any running Skype session without notification.&#xA;&#xA;Report options: Procedure Log, content: &quot;Skype deployed or updated to latest version.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement name="GetURL" continueOnFail="false" osType="MacOS">
                <Parameter xsi:type="StringParameter" name="URL" value="https://dl.google.com/chrome/mac/stable/GGRO/googlechrome.dmg" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#/googlechrome.dmg" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
                <Parameter xsi:type="StringParameter" name="Command" value="hdiutil mount -nobrowse #vAgentConfiguration.agentTempDir#/googlechrome.dmg" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
                <Parameter xsi:type="StringParameter" name="Command" value="cp -R &quot;/Volumes/Google Chrome/Google Chrome.app&quot; /Applications" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
                <Parameter xsi:type="StringParameter" name="Command" value="hdiutil unmount &quot;/Volumes/Google Chrome&quot;" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="false" osType="MacOS">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/googlechrome.dmg" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="MacOS">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome deployed or updated to latest version." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
      </Folder>
    </Folder>
    <Folder name="Windows" treePres="3">
      <Folder name="Application Deployment" treePres="3">
        <Folder name="Danish" treePres="3">
          <Procedure name="Application Deployment - Windows - Adobe Acrobat Reader DC - Danish - Deploy Latest" treePres="3" id="1597682317" folderId="354736505241476" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Danish">
            <Body description="">
              <Statement description="Procedure description: Deploy latest Danish Adobe Acrobat Reader DC. Removes any existing Adobe Reader/Acrobat Reader DC version and language.&#xD;&#xA;Kaseya customer value: Procedure to secure and standardize clients with the latest software and language.&#xD;&#xA;End user value: Limiting the risks for Adobe Reader exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule Once or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-05-04&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="https://admdownload.adobe.com/bin/live/readerdc_dk_xa_install.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/sAll /rs /l /msi /qb- /norestart EULA_ACCEPT=YES" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Let's do a post check to see if the software got installed properly." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="This is for Kaseya to understand the text file from the WMI command above. We have to re-encode it." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_version" />
              </Statement>
              <If description="">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="17.009.20044" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeReader" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Success! Latest Adobe Reader present on the system after deployment: #adobe_reader_version#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Fail! Adobe Reader present on the system after deployment but NOT latest versionl: #adobe_reader_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC - Danish - Deploy Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Firefox - Danish - Deploy Or Force Update To Latest" treePres="3" id="632796199" folderId="354736505241476" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Danish">
            <Body description="Description: The procedure will deploy or update to current Firefox version.&#xA;&#xA;Kaseya customer value: Procedure to secure clients by updating the software to latest version.&#xA;&#xA;End user value: Limiting the risks for malware, virus attacks, downtime and data loss due to unpatched web browser.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time. During the process any running Firefox will be closed without notification to the end user. &#xA;&#xA;Report options: Procedure Log, content: &quot;Firefox deployed or updated to latest version.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement description="Get the latest firefox install package from Mozilla." name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://download.mozilla.org/?product=firefox-latest&amp;os=win&amp;lang=da" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <If description="If Firefox is running, kill it. In this case without warning the user.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Execute the Firefox installer silently as local system." name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-ms" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
              </Statement>
              <Statement description="Let's take a note in the Agent Procedure Log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Firefox deployed or updated to latest version." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Folder name="Finnish" treePres="3">
          <Procedure name="Application Deployment - Windows - Adobe Acrobat Reader DC - Finnish - Deploy Latest" treePres="3" id="864679401" folderId="685827945305885" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Finnish">
            <Body description="">
              <Statement description="Procedure description: Deploy latest Finnish Adobe Acrobat Reader DC. Removes any existing Adobe Reader/Acrobat Reader DC version and language.&#xD;&#xA;Kaseya customer value: Procedure to secure and standardize clients with the latest software and language.&#xD;&#xA;End user value: Limiting the risks for Adobe Reader exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule Once or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-05-04&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="https://admdownload.adobe.com/bin/live/readerdc_fi_xa_install.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/sAll /rs /l /msi /qb- /norestart EULA_ACCEPT=YES" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Let's do a post check to see if the software got installed properly." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="This is for Kaseya to understand the text file from the WMI command above. We have to re-encode it." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_version" />
              </Statement>
              <If description="">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="17.009.20044" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeReader" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Success! Latest Adobe Reader present on the system after deployment: #adobe_reader_version#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Fail! Adobe Reader present on the system after deployment but NOT latest versionl: #adobe_reader_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC - Finnish - Deploy Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Firefox - Finnish - Deploy Or Force Update To Latest" treePres="3" id="2047266922" folderId="685827945305885" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Finnish">
            <Body description="Description: The procedure will deploy or update to current Firefox version.&#xA;&#xA;Kaseya customer value: Procedure to secure clients by updating the software to latest version.&#xA;&#xA;End user value: Limiting the risks for malware, virus attacks, downtime and data loss due to unpatched web browser.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time. During the process any running Firefox will be closed without notification to the end user. &#xA;&#xA;Report options: Procedure Log, content: &quot;Firefox deployed or updated to latest version.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement description="Get the latest firefox install package from Mozilla." name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://download.mozilla.org/?product=firefox-latest&amp;os=win&amp;lang=fi" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <If description="If Firefox is running, kill it. In this case without warning the user.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Execute the Firefox installer silently as local system." name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-ms" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
              </Statement>
              <Statement description="Let's take a note in the Agent Procedure Log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Firefox deployed or updated to latest version." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Folder name="Language Independent" treePres="3">
          <Procedure name="Application Deployment - Windows - 7-Zip - Deploy Latest (Simplified)" treePres="3" id="1508625787" folderId="120848714709677" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Language Independent">
            <Body description="">
              <If description="Is Windows OS 32bit?">
                <Condition name="Windows 32 or 64 Bit Check">
                  <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                </Condition>
                <Then>
                  <Statement description="Let's download the latest 7-Zip 32bit installer from http://downloads.sourceforge.net/project/sevenzip to the local kworking folder." name="GetURL" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="URL" value="https://www.7-zip.org/a/7z1805.msi" />
                    <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\7zip.msi" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                </Then>
              </If>
              <If description="Is Windows OS 64bit?">
                <Condition name="Windows 32 or 64 Bit Check">
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                </Condition>
                <Then>
                  <Statement description="Let's download the latest 7-Zip 64bit installer from http://downloads.sourceforge.net/project/sevenzip to the local kworking folder." name="GetURL" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="URL" value="https://www.7-zip.org/a/7z1805-x64.msi" />
                    <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\7zip.msi" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Execute the installer with a bunch of silent switches as local system account." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="msiexec /i #vAgentConfiguration.agentTempDir#\7zip.msi /q" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="After install, let's delete the installer package from the local kworking folder." name="DeleteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\7zip.msi" />
              </Statement>
              <Statement description="Procedure log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: 7-Zip deployed or updated to latest version" />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Adobe AIR - Deploy Latest" treePres="3" id="12189435" folderId="120848714709677" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Language Independent">
            <Body description="">
              <Statement description="Let's download tha latest Adobe AIR installer." name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="https://airdownload.adobe.com/air/win/download/29.0/AdobeAIRInstaller.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeAIR.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Execute the Adobe AIR installer." name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeAIR.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-silent -eulaAccepted" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Delete installer package." name="DeleteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeAIR.exe" />
              </Statement>
              <Statement description="Procedure log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air deployed or updated to latest version." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Adobe Flash Player ActiveX - Deploy Latest" treePres="3" id="1201867855" folderId="120848714709677" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Language Independent">
            <Body description="">
              <If description="Procedure description: Deploy Adobe Flash Player ActiveX. Update to latest if present.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Flash related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule or run now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: We look for Adobe Flash Player ActiveX on the system before dployment for reporting purposes.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Adobe Flash Player activeX in the registry before deployment, put it in a variable and finally write to the Agent Procedure log.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerActiveXVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX version before deployment (note: this is not the built in IE 10+ or Chrome version) identified as: #FlashPlayerActiveXVersion#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX not present on the system before deployment." />
                  </Statement>
                </Else>
              </If>
              <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: The deployment part." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Downloading Adobe Flash Player ActiveX installer from ftpdownload.macromedia.com" />
              </Statement>
              <Statement name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://fpdownload.macromedia.com/pub/flashplayer/latest/help/install_flash_player_ax.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="In this example the Adobe Flash Playser installer will run even if latest Flash already exist on the system. You can set extended IF/ELSE statements and registry checks to avoidi this." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX deployment." />
              </Statement>
              <If description="In order to get Adobe Flash Player ActiveX installed all Internet Explorer sessions have to be closed.&#xD;&#xA;The IF/ELSE statements below will try to kill iexplore.exe if running in three different ways.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                </Condition>
                <Then>
                  <Statement description="Let's try to kill &quot;iexplore.exe&quot; with the tools we have." name="CloseApplication" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic process where name=&quot;iexplore.exe&quot; call terminate" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="User" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="PauseScript" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="IntegerParameter" name="Seconds" value="10" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic process where name=&quot;iexplore.exe&quot; call terminate" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="PauseScript" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="IntegerParameter" name="Seconds" value="10" />
                  </Statement>
                  <If description="">
                    <Condition name="ApplicationRunning">
                      <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                    </Condition>
                    <Then>
                      <Statement description="If Internet Explorer is still running, we need to abort the ActiveX installation. We take a note in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internet Explorer failed to exit. Deployment of Adobe Flash Player ActiveX will not continue." />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement description="Internet Explorer is now closed and we are ready to execute the Adobe Flash Player ActiveX installer." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internet Explorer was running but closed successfully. Adobe Flash Player ActiveX deployment or update begins." />
                      </Statement>
                      <Statement name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
                        <Parameter xsi:type="StringParameter" name="Arguments" value="-install" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX deployment or update completed." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
              </If>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internet Explorer was not running. Adobe Flash Player ActiveX deployment or update begins." />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-install" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX deployment or update completed." />
              </Statement>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After deployment or update we look for Adobe Flash Player activeX on the system after deployment for reporting purposes.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Adobe Flash Player ActiveX in the registry after deployment or update, put it in a variable and finally write to the Agent Procedure log.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerActiveXVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeFlash" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="Adobe Flash Player ActiveX version after deploy or update (note: this is not the built in IE 10+ or Chrome version) identified as: #FlashPlayerActiveXVersion#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="No Adobe Flash Player ActiveX version identified in the registry. The deployment or update failed." />
                  </Statement>
                </Else>
              </If>
              <If description="">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerPluginVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="Adobe Flash Player Plugin version after deploy or update (note: this is not the built in IE 10+ or Chrome version) identified as: #FlashPlayerPluginVersion#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="No Adobe Flash Player plugin version identified in the registry. The deployment or update failed." />
                  </Statement>
                </Else>
              </If>
              <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX deployment. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Adobe Flash Player Plug-In - Deploy Latest" treePres="3" id="1733418089" folderId="120848714709677" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Language Independent">
            <Body description="">
              <If description="Procedure description: Deploy Adobe Flash Player Plug-In. Update to latest if present.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Flash related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule or run now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: We look for Adobe Flash Player Plug-In on the system before deployment for reporting purposes.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Adobe Flash Player Plug-In in the registry before deployment, put it in a variable and finally write to the Agent Procedure log.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerPluginVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plugin version before upgrade (note: this is not the built in IE 10+) identified as: #FlashPlayerPluginVersion#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In not present on the system before deployment." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Stage 2: The deployment part." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Downloading Adobe Flash Player installer from ftpdownload.macromedia.com" />
              </Statement>
              <Statement name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://fpdownload.macromedia.com/pub/flashplayer/latest/help/install_flash_player.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\install_flash_player_plugin.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player installer download from ftpdownload.macromedia.com completed." />
              </Statement>
              <Statement description="In this example the Adobe Flash Playser installer will run even if latest already exist on the system. You can set extended IF/ELSE statements and registry checks to avoidi this." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In deployment begins." />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_plugin.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-install" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In deployment completed." />
              </Statement>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_plugin.exe" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: We look for Adobe Flash Player ActiveX on the system after deployment for reporting purposes.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Adobe Flash Player in the registry after deployment or update, put it in a variable and finally write to the Agent Procedure log.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerPluginVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeFlash" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In version after deployment (note: this is not the built in IE 10+ or Chrome version) identified as: #FlashPlayerPluginVersion#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: No Adobe Flash Player Plug-In version identified in the registry. Deployment failed." />
                  </Statement>
                </Else>
              </If>
              <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In deployment. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Chrome - Deploy Latest" treePres="3" id="236981737" folderId="120848714709677" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Language Independent">
            <Body description="">
              <Statement description="Procedure description: Update Chrome to latest version. Deploy if not present.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for Chrome exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule or run now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before deployment or update we look for any existing Chrome on the system for reporting purposes.&#xD;&#xA;Let's get the Chrome version (if present) with a simple WMIC command." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Google%Chrome%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\chrome_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="PauseScript" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="IntegerParameter" name="Seconds" value="30" />
              </Statement>
              <Statement description="To get a proper Agent Procedure log entry we have to convert the above result to a encoding Kaseya understands in order to use it as a variable. In this case we re-type the file to become UTF." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\chrome_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="chrome_version" />
              </Statement>
              <If description="The IF/ELSE statment below will put relevant information in the Agent Procedure log for reporting and deployment purposes.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\skype_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Google Chrome" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome not detected on the system before deployment." />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome detected on the system before update: #chrome_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\chrome_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
              </Statement>
              <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: The deployment or update part.&#xD;&#xA;Let's download the latest Google Chrome Busniess MSI installer." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Begin downloading Chrome MSI installer." />
              </Statement>
              <Statement name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="https://dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7B4FA2C409-B18B-777B-306D-26DB95543621%7D%26lang%3Dsv%26browser%3D4%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dprefers%26installdataindex%3Ddefaultbrowser/edgedl/chrome/install/GoogleChromeStandaloneEnterprise.msi" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\chrome.msi" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome MSI installer downloaded successfully." />
              </Statement>
              <If description="If Chrome is running, kill it.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="chrome.exe" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome was running before update and therefore killed." />
                  </Statement>
                  <Statement name="CloseApplication" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="chrome.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Executing Chrome MSI installer." />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="c:\windows\system32\msiexec.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/i #vAgentConfiguration.agentTempDir#\chrome.msi /norestart /quiet" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome installed." />
              </Statement>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\chrome.msi" />
              </Statement>
              <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After deployment or update we look for any existing Chrome on the system for reporting purposes." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Google%Chrome%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\chrome_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="PauseScript" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="IntegerParameter" name="Seconds" value="30" />
              </Statement>
              <Statement description="To get a proper Agent Procedure log entry we have to convert the above result to a encoding Kaseya understands in order to use it as a variable. In this case we re-type the file to become UTF." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\chrome_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="chrome_version" />
              </Statement>
              <If description="The IF/ELSE statment below will put relevant information in the Agent Procedure log for reporting and deployment purposes.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Google Chrome" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome not detected on the system after deployment or update." />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome detected on the system after update: #chrome_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\chrome_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\chrome_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Chrome - Deploy Or Force Update To Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Java 8 32Bit - Deploy Latest" treePres="3" id="281594058" folderId="120848714709677" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Language Independent">
            <Body description="">
              <Statement description="Procedure description: Deploy latest Java 8 32Bit version. Removes any older Java 8 32Bit version before deployment.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related attacks, downtime and data loss.&#xD;&#xA;Dependencies: Windows OS. Edit the version string to latest for compliance check. Follow the important notes.&#xD;&#xA;Usage: Schedule or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Last change: 2018-10-26&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we deploy, let's audit the system for any Java 8 32Bit present and do some cleanup." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%8%Update%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt;#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <If description="Is any older Java 8 32Bit version detected? If so, let's remove it.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update" />
                </Condition>
                <Then>
                  <If description="IMPORTANT NOTE: When detected, is it the latest version? You have to change Does Not Contain &quot;Name=Java 8 Update XXX&quot; to new version when released.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 191" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Older Java 8 32Bit version detected and will be removed. #java_version#" />
                      </Statement>
                      <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;name like 'Java%8%Update%'&quot; call uninstall /nointeractive" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Older Java 8 32Bit version removed." />
                      </Statement>
                    </Then>
                  </If>
                </Then>
              </If>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: The Deployment part&#xD;&#xA;IMPORTANT NOTE: Is it not the latest version? You have to change Does Not Contain &quot;Name=Java 8 Update XXX&quot; to new version when released.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 191" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Downloading latest Java 8 32Bit installer." />
                  </Statement>
                  <Statement name="GetURL" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="URL" value="http://javadl.oracle.com/webapps/download/AutoDL?BundleId=235725_2787e4a523244c269598db4e85c51e0c" />
                    <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\java32.exe" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Deployment begins." />
                  </Statement>
                  <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java32.exe" />
                    <Parameter xsi:type="StringParameter" name="Arguments" value="/s REBOOT=Suppress /L #vAgentConfiguration.agentTempDir#\java8-32bit-install.log" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Deployment completed. If needed, evaluate the log at &quot;#vAgentConfiguration.agentTempDir#\java8-32bit-install.log&quot;." />
                  </Statement>
                  <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java32.exe" />
                  </Statement>
                  <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After deployment, let's audit the system for latest Java 8 32Bit present for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%8%Update%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
                  </Statement>
                  <If description="IMPORTANT NOTE: You have to change Contain &quot;Name=Java 8 Update XXX&quot; to new version when new versions get released.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 191" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Success! #java_version#" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy Java8" />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Failed! Latest Java 8 32Bit not detected. Evaluate the log at &quot;#vAgentConfiguration.agentTempDir#\java8-32bit-install.log&quot;." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="If latest Java 8 32Bit version is detected at the beginning of Step 2, we take a note of that in the Agent Procedure Log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: Latest version already installed. No action taken. #java_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit deployment: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Folder name="Norwegian" treePres="3">
          <Procedure name="Application Deployment - Windows - Adobe Acrobat Reader DC - Norwegian - Deploy Latest" treePres="3" id="1958378504" folderId="907770064523336" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Norwegian">
            <Body description="">
              <Statement description="Procedure description: Deploy latest Norwegian Adobe Acrobat Reader DC. Removes any existing Adobe Reader/Acrobat Reader DC version and language.&#xD;&#xA;Kaseya customer value: Procedure to secure and standardize clients with the latest software and language.&#xD;&#xA;End user value: Limiting the risks for Adobe Reader exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule Once or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-05-04&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="https://admdownload.adobe.com/bin/live/readerdc_no_xa_install.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/sAll /rs /l /msi /qb- /norestart EULA_ACCEPT=YES" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Let's do a post check to see if the software got installed properly." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="This is for Kaseya to understand the text file from the WMI command above. We have to re-encode it." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_version" />
              </Statement>
              <If description="">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="17.009.20044" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeReader" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Success! Latest Adobe Reader present on the system after deployment: #adobe_reader_version#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Fail! Adobe Reader present on the system after deployment but NOT latest versionl: #adobe_reader_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC - Norwegian - Deploy Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Firefox - Norwegian - Deploy Or Force Update To Latest" treePres="3" id="1951287604" folderId="907770064523336" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Norwegian">
            <Body description="Description: The procedure will deploy or update to current Firefox version.&#xA;&#xA;Kaseya customer value: Procedure to secure clients by updating the software to latest version.&#xA;&#xA;End user value: Limiting the risks for malware, virus attacks, downtime and data loss due to unpatched web browser.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time. During the process any running Firefox will be closed without notification to the end user. &#xA;&#xA;Report options: Procedure Log, content: &quot;Firefox deployed or updated to latest version.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement description="Get the latest firefox install package from Mozilla." name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://download.mozilla.org/?product=firefox-latest&amp;os=win&amp;lang=nb-NO" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <If description="If Firefox is running, kill it. In this case without warning the user.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Execute the Firefox installer silently as local system." name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-ms" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
              </Statement>
              <Statement description="Let's take a note in the Agent Procedure Log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Firefox deployed or updated to latest version." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Folder name="Swedish" treePres="3">
          <Procedure name="Application Deployment - Windows - Adobe Acrobat Reader DC - Swedish - Deploy Latest" treePres="3" id="1412646469" folderId="555382382336716" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Swedish">
            <Body description="">
              <Statement description="Procedure description: Deploy latest Swedish Adobe Acrobat Reader DC. Removes any existing Adobe Reader/Acrobat Reader DC version and language.&#xD;&#xA;Kaseya customer value: Procedure to secure and standardize clients with the latest software and language.&#xD;&#xA;End user value: Limiting the risks for Adobe Reader exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule Once or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-06-20&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="https://admdownload.adobe.com/bin/live/readerdc_sv_xa_install.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/sAll /rs /l /msi /qb- /norestart EULA_ACCEPT=YES" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Let's do a post check to see if the software got installed properly." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="This is for Kaseya to understand the text file from the WMI command above. We have to re-encode it." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_version" />
              </Statement>
              <If description="">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="17.009.20044" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeReader" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Success! Latest Adobe Reader present on the system after deployment: #adobe_reader_version#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Fail! Adobe Reader present on the system after deployment but NOT latest versionl: #adobe_reader_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC - Swedish - Deploy Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Firefox - Swedish - Deploy Latest" treePres="3" id="1150500858" folderId="555382382336716" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.Swedish">
            <Body description="">
              <Statement description="MSSP: Install latest version of Firefox. Swedish." name="GetURL" continueOnFail="false">
                <Parameter xsi:type="StringParameter" name="URL" value="http://download.mozilla.org/?product=firefox-latest&amp;os=win&amp;lang=sv-SE" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <If description="If Firefox is running, kill it.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-ms" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="MSSP: Tags: #Firefox #Appdeploy #Apprepair" />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Folder name="US English" treePres="3">
          <Procedure name="Application Deployment - Windows - Adobe Acrobat Reader DC - US English - Deploy Latest" treePres="3" id="611859724" folderId="895836722988558" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.US English">
            <Body description="">
              <Statement description="Procedure description: Deploy latest US English Adobe Acrobat Reader DC. Removes any existing Adobe Reader/Acrobat Reader DC version and language.&#xD;&#xA;Kaseya customer value: Procedure to secure and standardize clients with the latest software and language.&#xD;&#xA;End user value: Limiting the risks for Adobe Reader exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule Once or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-05-04&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="https://admdownload.adobe.com/bin/live/readerdc_en_xa_install.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/sAll /rs /l /msi /qb- /norestart EULA_ACCEPT=YES" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Let's do a post check to see if the software got installed properly." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="This is for Kaseya to understand the text file from the WMI command above. We have to re-encode it." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_version" />
              </Statement>
              <If description="">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="17.009.20044" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppDeploy AdobeReader" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Success! Latest Adobe Reader present on the system after deployment: #adobe_reader_version#" />
                  </Statement>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Fail! Adobe Reader present on the system after deployment but NOT latest versionl: #adobe_reader_version#" />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeReaderDC.exe" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC - US English - Deploy Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Deployment - Windows - Firefox - US English - Deploy Or Force Update To Latest" treePres="3" id="604768824" folderId="895836722988558" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Deployment.US English">
            <Body description="Description: The procedure will deploy or update to current Firefox version.&#xA;&#xA;Kaseya customer value: Procedure to secure clients by updating the software to latest version.&#xA;&#xA;End user value: Limiting the risks for malware, virus attacks, downtime and data loss due to unpatched web browser.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time. During the process any running Firefox will be closed without notification to the end user. &#xA;&#xA;Report options: Procedure Log, content: &quot;Firefox deployed or updated to latest version.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement description="Get the latest firefox install package from Mozilla." name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://download.mozilla.org/?product=firefox-latest&amp;os=win&amp;lang=en-US" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <If description="If Firefox is running, kill it. In this case without warning the user.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Execute the Firefox installer silently as local system." name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-ms" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\firefox.exe" />
              </Statement>
              <Statement description="Let's take a note in the Agent Procedure Log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Firefox deployed or updated to latest version." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
      </Folder>
      <Folder name="Application Removal" treePres="3">
        <Folder name="Language Independent" treePres="3">
          <Procedure name="Remove Application - Windows - F-Secure Removal Example" treePres="3" id="66127689" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="Description: Detects current disk temperature and writes the results to the script log. Many thanks to Dave Wujcik with IronOakIT for finding disktemp.exe! &#xA;&#xA;Kaseya customer value: Procedure to secure clients from unwanted downtime and data loss.&#xA;&#xA;End user value: Limiting the risks for unwanted downtime and data loss.&#xA;&#xA;Dependencies: Windows OS. Make sure you have created &quot;Disk Temp&quot; (string) under &quot;Audit, Custom Fields&quot;.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;GetDiskTemp:*&quot; and Aggregate Table, Diskt Temp.&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement name="GetURL" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="URL" value="ftp://ftp.f-secure.com/support/tools/uitool/UninstallationTool.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\F-Secure\F-SecureUninstallationTool.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\F-Secure\F-SecureUninstallationTool.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-s -a --NOGUI" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="False" />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Prompt For App String" treePres="3" id="2026330446" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="Description: This Kaseya Agent Procedure will demonstrate how to remove a specific application based on the application ID string. You can copy any string from Audit, Add/Remove section in Kaseya.&#xA;&#xA;Kaseya customer value: Procedure to remove unwanted software.&#xA;&#xA;End user value: Limiting the risks for unwanted external attacks related to unwanted and unauthorized software.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Remove application:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="Prompt" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="Enter the remove string for the application. You can find it in the Audit module under Add/Remove, Example: {89F4137D-6C26-4A84-BDB8-2E5A4BB71E00}" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="windows_remove_string" />
              </Statement>
              <Statement description="Removes Apple iTunes from the command line." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="msiexec /qn /x #windows_remove_string#" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Remove application: Application with remove string #windows_remove_string# removed from machine." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove ALL Adobe Flash Player Versions" treePres="3" id="1068535228" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="Description: Force any Adobe Flash Player version to be uninstalled.&#xA;&#xA;Kaseya customer value: Procedure to secure clients by removing unwanted software.&#xA;&#xA;End user value: Limiting the risks for unwanted external Flash related attacks, downtime and data loss.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time. The installer will close any running web browser without notification.&#xA;&#xA;Report options: Procedure Log, content: &quot;Adobe Flash Player removed. Do a fresh Audit on the machine to verify.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement description="This Kaseya Agent Procedures is based on the information from: http://forums.adobe.com/message/4041846&#xD;&#xA;Let's download Adobe Flash Player uninstaller." name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://download.macromedia.com/get/flashplayer/current/support/uninstall_flash_player.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\uninstall_flash_player.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <If description="If Chrome is running, kill it.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="chrome.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="chrome.exe" />
                  </Statement>
                </Then>
              </If>
              <If description="If Firefox is running, kill it.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="firefox.exe" />
                  </Statement>
                </Then>
              </If>
              <If description="If Internet Explorer is running, kill it.">
                <Condition name="ApplicationRunning">
                  <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore" />
                </Condition>
                <Then>
                  <Statement name="CloseApplication" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Execute the stand alone Flash uninstaller silently." name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\uninstall_flash_player.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="-uninstall" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\uninstall_flash_player.exe" />
              </Statement>
              <Statement name="Delete Directory" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Parameter1" value="C:\WINDOWS\System32\Macromed\Flash" />
                <Parameter xsi:type="StringParameter" name="Parameter2" value="true" />
              </Statement>
              <If description="">
                <Condition name="Windows 32 or 64 Bit Check">
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                </Condition>
                <Then>
                  <Statement name="Delete Directory" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Parameter1" value="C:\Windows\SysWOW64\Macromed\Flash" />
                    <Parameter xsi:type="StringParameter" name="Parameter2" value="true" />
                  </Statement>
                </Then>
              </If>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player removed. Do a fresh Audit on the machine to verify." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove ALL Citrix Reciever Versions" treePres="3" id="410407043" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="Description: This procedure deploys or update 7-Zip to latest version. &#xA;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xA;&#xA;End user value: Procedure to enhance user experience and add more functions to the desktop experience.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;7-Zip deployed or updated to latest version&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
              <Statement description="Let's download the latest 7-Zip 32bit installer from http://downloads.sourceforge.net/project/sevenzip to the local kworking folder.&#xD;&#xA;Execute the installer with a bunch of silent switches as local system account." name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="URL" value="http://support.citrix.com/servlet/KbServlet/download/35110-102-706128/ReceiverCleanupUtility.exe" />
                <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\ReceiverCleanupUtility.exe" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ReceiverCleanupUtility.exe" />
                <Parameter xsi:type="StringParameter" name="Arguments" value="/silent" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ReceiverCleanupUtility.exe" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Citrix Reciever removed." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove ALL Java 6 Versions" treePres="3" id="1600085463" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="">
              <Statement description="Procedure description: This procedure removes any Java 6 version if present on the system.&#xD;&#xA;Kaseya customer value: Procedure to remove old or unwanted software. Oracle has stopped public support of Java 6 as of Feb 2013.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Java 6 present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we start Java 6 removal, let's audit the system for any Java 6 present.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Java 6." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java(TM)%6%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We wait a minute for the above shell command to finish up." name="PauseScript" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="IntegerParameter" name="Seconds" value="60" />
              </Statement>
              <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Java 6 detected. Let's start the removal.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Version=6.0." />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 present on the system and indentified as: #java_version#" />
                  </Statement>
                  <Statement description="Let's execute a WMI command to remove all appliations beginning with Java 7 and put the returned output in a text file." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal procedure begins. A 5 minute pause will be added." />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="start /w wmic product where &quot;name like 'Java(TM)%6%'&quot; call uninstall /nointeractive &gt;&gt;#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal Procedure continues after a 3 minute pause." />
                  </Statement>
                  <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="IntegerParameter" name="Seconds" value="30" />
                  </Statement>
                  <Statement description="Let's create a variable of get the returned output for reporting puposes." name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="RemoveJavaResult" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal Procedure results: #RemoveJavaResult#" />
                  </Statement>
                  <Statement description="Let's do some housecleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                  </Statement>
                  <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After Java 6 removal we audit the system for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java(TM)%6%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We wait a minute for the above shell command to finish up." name="PauseScript" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="IntegerParameter" name="Seconds" value="60" />
                  </Statement>
                  <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
                  </Statement>
                  <If description="The IF/ELSE statements below will look for existing trace of Java 6.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Version=6.0." />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal Procedure failed. Java7 still present on the system after removal attempt. Indentified as: #java_version#" />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal Procedure ran successfully. No Java 6 left on the system." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal Procedure did not execute. No Java 6 detected." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning from stage 3 if files exist." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 6 removal Procedure. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove ALL Java 7 Versions" treePres="3" id="335532313" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="">
              <Statement description="Procedure description: This procedure removes any Java 7 version if present on the system.&#xD;&#xA;Kaseya customer value: Procedure to remove old or unwanted software. Oracle will stop public support of Java 7 April 2015.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Java 7 present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we start Java 7 removal, let's audit the system for any Java 7 present.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Java 7." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%7%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We wait a minute for the above shell command to finish up.&#xD;&#xA;We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Java 7 detected. Let's start the removal.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Version=7.0." />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 7 present on the system and indentified as: #java_version#" />
                  </Statement>
                  <Statement description="Let's execute a WMI command to remove all appliations beginning with Java 7 and put the returned output in a text file." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="start /w wmic product where &quot;name like 'Java%7%Update%'&quot; call uninstall /nointeractive &gt;&gt;#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="IntegerParameter" name="Seconds" value="30" />
                  </Statement>
                  <Statement description="Let's create a variable of get the returned output for reporting puposes." name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="RemoveJavaResult" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 7 removal Procedure results: #RemoveJavaResult#" />
                  </Statement>
                  <Statement description="Let's do some housecleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                  </Statement>
                  <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After Java 7 removal we audit the system for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%7%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We wait a minute for the above shell command to finish up.&#xD;&#xA;We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
                  </Statement>
                  <If description="The IF/ELSE statements below will look for existing trace of Java7.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Version=7.0." />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 7 removal Procedure failed. Java7 still present on the system after removal attempt. Indentified as: #java_version#" />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 7 removal Procedure ran successfully. No Java7 left on the system." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="//No Java 7 detected, so no action taken." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 7 removal Procedure did not execute. No Java7 detected." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning from stage 3 if files exist." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 7 removal. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove ALL Java 8 Versions" treePres="3" id="986569598" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="">
              <Statement description="Procedure description: This procedure removes any Java 8 version if present on the system.&#xD;&#xA;Kaseya customer value: Procedure to remove old or unwanted software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Java 8 present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we start Java 8 removal, let's audit the system for any Java 7 present.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Java 8." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We wait a minute for the above shell command to finish up.&#xD;&#xA;We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Java 8 detected. Let's start the removal.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Version=8.0." />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 present on the system and indentified as: #java_version#" />
                  </Statement>
                  <Statement description="Let's execute a WMI command to remove all appliations beginning with Java 7 and put the returned output in a text file." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 removal begins." />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="start /w wmic product where &quot;name like 'Java%8%Update%'&quot; call uninstall /nointeractive &gt;&gt;#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="IntegerParameter" name="Seconds" value="30" />
                  </Statement>
                  <Statement description="Let's create a variable of get the returned output for reporting puposes." name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="RemoveJavaResult" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 removal Procedure results: #RemoveJavaResult#" />
                  </Statement>
                  <Statement description="Let's do some housecleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\RemoveJava.result" />
                  </Statement>
                  <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After Java 8 removal we audit the system for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
                  </Statement>
                  <If description="The IF/ELSE statements below will look for existing trace of Java 8.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Version=8.0." />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 removal Procedure failed. Java 8 still present on the system after removal attempt. Indentified as: #java_version#" />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 removal Procedure ran successfully. No Java 8 left on the system." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="//No Java 7 detected, so no action taken." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 removal Procedure did not execute. No Java 8 detected." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning from stage 3 if files exist." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 removal. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove Java Updater" treePres="3" id="1637606884" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="">
              <Statement description="Procedure description: This procedure example removes Java Auto Updater if present on the system.&#xD;&#xA;Kaseya customer value: Procedure to remove unwanted software.&#xD;&#xA;End user value: Procedure to remove unwanted software.&#xD;&#xA;Dependencies: Windows OS. Java Auto Updater present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we start Java Auto Updater removal, let's audit the system." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%Auto%Updater'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_auto_updater.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_auto_updater.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_auto_updater_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_auto_updater_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="java_auto_updater_version" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Java Auto Updater detected. Let's start the removal.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_auto_updater_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Java Auto Updater" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java Auto Updater Removal: Java Auto Updater present on the system and indentified as: #java_auto_updater_version#" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java Auto Updater Removal: Removal begins." />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="start /w wmic product where &quot;name like 'Java%Auto%Updater'&quot; call uninstall /nointeractive" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="Let's do some housecleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_auto_updater.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  </Statement>
                  <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After Java Auto Update removal we audit the system for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%Auto%Updater'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_auto_updater.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_auto_updater.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_auto_updater_utf.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_auto_updater_utf.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="java_auto_updater_version" />
                  </Statement>
                  <If description="The IF/ELSE statements below will look for existing trace of specific Java 8.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Name=Java Auto Updater" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java Auto Updater Removal: Removal Procedure failed. Java Auto Updater still present and indentified as: #java_auto_updater_version#" />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java Auto Updater Removal: Removal Procedure ran successfully." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="No Java Auto Updater detected in the first place. No action taken." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java Auto Updater Removal: Java Auto Updater not detected. No action taken." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning from stage 3 if files exist." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_auto_updater.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java Auto Updater Removal: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove SPECIFIC Java 8 Version Example" treePres="3" id="253566683" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="">
              <Statement description="Procedure description: This procedure example removes a specific  Java 8 version if present on the system.&#xD;&#xA;Kaseya customer value: Procedure to remove old or unwanted software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Java 8 present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we start Java 8 removal, let's audit the system for any Java 8 present.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Java 8." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We wait a minute for the above shell command to finish up.&#xD;&#xA;We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Java 8 detected. Let's start the removal.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 60" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Specific Java 8 version removal: Java 8 present on the system and indentified as: #java_version#" />
                  </Statement>
                  <Statement description="Let's execute a WMI command to remove a specific Java 8 and put the returned output in a text file." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Specific Java 8 version removal: Java 8 removal begins." />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="start /w wmic product where &quot;name like 'Java%8%Update%60'&quot; call uninstall /nointeractive" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="Let's do some housecleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  </Statement>
                  <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After specific Java 8 removal we audit the system for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
                  </Statement>
                  <If description="The IF/ELSE statements below will look for existing trace of specific Java 8.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 60" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Specific Java 8 version removal: Specific Java 8 version removal: Procedure ran successfully." />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Specific Java 8 version removal: Java 8 removal Procedure failed. Java 8 still present on the system after removal attempt. Indentified as: #java_version#" />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="//No Java 7 detected, so no action taken." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Specific Java 8 version removal: Specific Java 8 version removal: Java 8 removal Procedure did not execute. No specified Java 8 version detected." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning from stage 3 if files exist." name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Specific Java 8 version removal: Specific Java 8 version removal: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Remove Application - Windows - Remove TeamViewer Example" treePres="3" id="904603968" folderId="460252944128705" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Removal.Language Independent">
            <Body description="">
              <If description="Procedure description: This procedure removes any Java 7 version if present on the system.&#xD;&#xA;Kaseya customer value: Procedure to remove old or unwanted software. Oracle will stop public support of Java 7 April 2015.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Java 7 present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Is TeamViewer service running?">
                <Condition name="ServiceIsRunning">
                  <Parameter xsi:type="StringParameter" name="ServiceName" value="TeamViewer" />
                </Condition>
                <Then>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TeamViewer service is running on the system." />
                  </Statement>
                  <If description="">
                    <Condition name="Windows 32 or 64 Bit Check">
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                    </Condition>
                    <Then>
                      <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="C:\Program Files (x86)\TeamViewer\uninstall.exe" />
                        <Parameter xsi:type="StringParameter" name="Arguments" value="/S" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="C:\Program Files\TeamViewer\uninstall.exe" />
                        <Parameter xsi:type="StringParameter" name="Arguments" value="/S" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                    </Else>
                  </If>
                  <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Let's check for TeamViewer service running after uninstall.">
                    <Condition name="ServiceIsRunning">
                      <Parameter xsi:type="StringParameter" name="ServiceName" value="TeamViewer" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TeamViewer removal failed! Service is still running." />
                      </Statement>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TeamViewer removal success! Service not running." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="//No Java 7 detected, so no action taken." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TeamViewer removal Procedure did not execute. Not detected." />
                  </Statement>
                </Else>
              </If>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TeamViewer removal. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
      </Folder>
      <Folder name="Application Update" treePres="3">
        <Folder name="Language Independent" treePres="3">
          <Procedure name="Application Update - Windows - Adobe Air - Update To Latest" treePres="3" id="1974795337" folderId="919000816493767" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Update.Language Independent">
            <Body description="">
              <Statement description="Procedure description: Update to latest Adobe Air version.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Adobe Air related attacks, downtime and data loss.&#xD;&#xA;Dependencies: Windows OS. Adobe Air present.&#xD;&#xA;Usage: Schedule or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Last change: 2018-05-04&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we update, let's audit the system for any Adobe Air present." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Air'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_air_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_air_version.result &gt;&gt;#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_air_version" />
              </Statement>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: The update part. We only continue with the update if Adobe Air is present.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Adobe AIR" />
                </Condition>
                <Then>
                  <If description="">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Version=29.0.0.112" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Older version of Adobe Air detected: #adobe_air_version#." />
                      </Statement>
                      <Statement description="IMPORTANT NOTE: Change the family version name (27.x to 28.x etc) in &quot;getURL&quot; path when new versions arrive." name="GetURL" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="URL" value="http://airdownload.adobe.com/air/win/download/29.0/AdobeAIRInstaller.exe" />
                        <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdobeAIR.exe" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Executing Adobe Air installer." />
                      </Statement>
                      <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeAIR.exe" />
                        <Parameter xsi:type="StringParameter" name="Arguments" value="-silent -eulaAccepted" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Update completed." />
                      </Statement>
                      <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version.result" />
                      </Statement>
                      <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                      </Statement>
                      <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdobeAIR.exe" />
                      </Statement>
                      <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After update, let's audit the system for any Adobe Air present for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Air'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_air_version.result" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_air_version.result &gt;&gt;#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                        <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                        <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_air_version" />
                      </Statement>
                      <If description="">
                        <Condition name="TestFile">
                          <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
                          <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                          <Parameter xsi:type="StringParameter" name="Value" value="Name=Adobe AIR" />
                        </Condition>
                        <Then>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Present on the system after update: #adobe_air_version#" />
                          </Statement>
                        </Then>
                        <Else>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Not present on the system after update. Evaluate installation log locally." />
                          </Statement>
                        </Else>
                      </If>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Latest version of Adobe Air detected. No action taken. #adobe_air_version#." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: Not present on the system. No action taken." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_air_version_utf.result" />
              </Statement>
              <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Air Update: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Update - Windows - Adobe Flash Player - Update To Latest" treePres="3" id="1668037405" folderId="919000816493767" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Update.Language Independent">
            <Body description="">
              <If description="Procedure description: Update Adobe Flash Player ActiveX and/or Plug-In to latest version if any version already present on the system.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Flash related exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Adobe Flash Player already present.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Last change: 2017-12-05&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before update we look for any Adobe Flash Player on the system.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Adobe Flash Player ActiveX in the registry before update and update to latest if present.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerActiveXVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX version before upgrade (note: this is not the built in IE 10+ or Chrome version) identified as: #FlashPlayerActiveXVersion#" />
                  </Statement>
                  <Statement description="Now that we found Adobe Flash Player ActivX present on te system, let's update to the latest version." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Downloading Adobe Flash Player ActiveX installer from ftpdownload.macromedia.com" />
                  </Statement>
                  <Statement name="GetURL" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="URL" value="http://fpdownload.macromedia.com/pub/flashplayer/latest/help/install_flash_player_ax.exe" />
                    <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX installer download completed." />
                  </Statement>
                  <If description="In order to get Adobe Flash Player ActiveX installed all Internet Explorer sessions have to be closed.&#xD;&#xA;The IF/ELSE statements below will try to kill iexplore.exe if running in three different ways.">
                    <Condition name="ApplicationRunning">
                      <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                    </Condition>
                    <Then>
                      <Statement description="Let's try to kill &quot;iexplore.exe&quot; with the various tools we have." name="CloseApplication" continueOnFail="true" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                      </Statement>
                      <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="wmic process where name=&quot;iexplore.exe&quot; call terminate" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="User" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="wmic process where name=&quot;iexplore.exe&quot; call terminate" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <If description="Let's check once again if &quot;iexplore.exe&quot; is running. ">
                        <Condition name="ApplicationRunning">
                          <Parameter xsi:type="StringParameter" name="ApplicationName" value="iexplore.exe" />
                        </Condition>
                        <Then>
                          <Statement description="If Internet Explorer is still running, we need to abort the ActiveX part of the update. We take a note in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internet Explorer is still running. Adobe Flash Player ActiveX update will not continue." />
                          </Statement>
                        </Then>
                        <Else>
                          <Statement description="Internet Explorer is now closed and we are ready to execute the Adobe Flash Player ActiveX installer." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internet Explorer was running but closed successfully. Adobe Flash Player ActiveX update begins." />
                          </Statement>
                          <Statement name="ExecuteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                            <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
                            <Parameter xsi:type="StringParameter" name="Arguments" value="-install" />
                            <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                            <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                          </Statement>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppUpdate AdobeReader" />
                          </Statement>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX update completed." />
                          </Statement>
                        </Else>
                      </If>
                    </Then>
                    <Else>
                      <Statement description="No Internet Explorer sessions seems to be opened. Adobe Flash Player ActiveX will get updated." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internet Explorer was running but closed successfully. Adobe Flash Player ActiveX update begins." />
                      </Statement>
                      <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
                        <Parameter xsi:type="StringParameter" name="Arguments" value="-install" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX update completed." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="If Adobe Flash Player ActiveX is not present on the system we do nothing." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX not present on the system . No update action taken." />
                  </Statement>
                </Else>
              </If>
              <If description="The IF/ELSE statements below will look for existing trace of Adobe Flash Player Plug-In in the registry before update.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerPluginVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plugin version before upgrade (note: for Firefox, Opera etc) identified as: #FlashPlayerPluginVersion#" />
                  </Statement>
                  <Statement description="Now that we found Adobe Flash Player Plugin present on te system, let's update to the latest version." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Downloading Adobe Flash Player Plug-In installer from ftpdownload.macromedia.com" />
                  </Statement>
                  <Statement name="GetURL" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="URL" value="http://fpdownload.macromedia.com/pub/flashplayer/latest/help/install_flash_player.exe" />
                    <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\install_flash_player_plugin.exe" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In installer download completed." />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In update begins." />
                  </Statement>
                  <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_plugin.exe" />
                    <Parameter xsi:type="StringParameter" name="Arguments" value="-install" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppUpdate AdobeReader" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In update completed." />
                  </Statement>
                </Then>
                <Else>
                  <Statement description="If Adobe Flash Player Plug-In is not present on the system we do nothing." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In not present on the system . No update action taken." />
                  </Statement>
                </Else>
              </If>
              <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: After update we look for Adobe Flash Player on the system for reporting purposes.&#xD;&#xA;The IF/ELSE statements below will look for existing trace of Adobe Flash Player in the registry after update for validation.">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerActiveX\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerActiveXVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player ActiveX version after update identified as: #FlashPlayerActiveXVersion#" />
                  </Statement>
                </Then>
              </If>
              <If description="">
                <Condition name="CheckRegistryValue">
                  <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="" />
                </Condition>
                <Then>
                  <Statement name="GetVariable" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="RegistryValue" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="HKEY_LOCAL_MACHINE\SOFTWARE\Macromedia\FlashPlayerPlugin\Version" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="FlashPlayerPluginVersion" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player Plug-In version after update identified as: #FlashPlayerPluginVersion#" />
                  </Statement>
                </Then>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_active_x.exe" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\install_flash_player_plugin.exe" />
              </Statement>
              <Statement description="This is a final notification in the Agent Procedure." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Flash Player update. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Update - Windows - Adobe Reader DC - Update To Latest" treePres="3" id="1593162675" folderId="919000816493767" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Update.Language Independent">
            <Body description="">
              <Statement description="Procedure description: Update existing Adobe acrobat Reader DC to latest version.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for Adobe Acrobat Reader DC exploits, phishing attacks, downtime and possible data loss.&#xD;&#xA;Dependencies: Windows OS. Adobe Acrobat Reader DC present.&#xD;&#xA;Usage: Schedule Once, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2018-01-31&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before update begins we look for any existing Adobe Acrobat Reader DC on the system." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_DC_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="To get a proper Agent Procedure log entry and varibale we have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_DC_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_DC_version" />
              </Statement>
              <If description="We look for the latest version being present. If not we will continue with the update process.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Version=" />
                </Condition>
                <Then>
                  <If description="">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Name=Adobe Acrobat Reader DC" />
                    </Condition>
                    <Then>
                      <If description="">
                        <Condition name="TestFile">
                          <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                          <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                          <Parameter xsi:type="StringParameter" name="Value" value="Version=18.011.20038" />
                        </Condition>
                        <Then>
                          <Statement description="Ok, nothing to do here. Latest vesion detected. Let's put that in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Latest Adobe Acrobat Reader DC detected on the system. No action taken. #adobe_reader_DC_version#" />
                          </Statement>
                        </Then>
                        <Else>
                          <Statement description="Stage 2: The update part.&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Here we go! If Adobe Acrobat Reader DC  is detected and NOT the latest version we continue with the update process." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC detected on the system but NOT latest: #adobe_reader_version#" />
                          </Statement>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Begin downloading Adobe Acrobat Reader DC update package. It can be big." />
                          </Statement>
                          <Statement name="GetURL" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="URL" value="ftp://ftp.adobe.com/pub/adobe/reader/win/AcrobatDC/1801120038/AcroRdrDCUpd1801120038.msp" />
                            <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\AdbeRdrUpd.msp" />
                            <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                          </Statement>
                          <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Path" value="c:\windows\system32\msiexec.exe" />
                            <Parameter xsi:type="StringParameter" name="Arguments" value="/p #vAgentConfiguration.agentTempDir#\AdbeRdrUpd.msp /qn /norestart" />
                            <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                            <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                          </Statement>
                          <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\AdbeRdrUpd.msp" />
                          </Statement>
                          <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: This is the vaildation part. Let's check for Adobe Acrobat Reader DC version once again." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Adobe%Acrobat%Reader%DC%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_DC_version.result" />
                            <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                            <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                          </Statement>
                          <Statement description="To get a proper Agent Procedure log entry and varibale we have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\adobe_reader_DC_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                            <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                            <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                          </Statement>
                          <Statement description="Now we can get the file content and use it as a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                            <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                            <Parameter xsi:type="StringParameter" name="VariableName" value="adobe_reader_DC_version" />
                          </Statement>
                          <If description="We look for the latest Adobe Reader DC version as a validation for success.">
                            <Condition name="TestFile">
                              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                              <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                              <Parameter xsi:type="StringParameter" name="Value" value="Version=" />
                            </Condition>
                            <Then>
                              <If description="">
                                <Condition name="TestFile">
                                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
                                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                                  <Parameter xsi:type="StringParameter" name="Value" value="Version=18.011.20038" />
                                </Condition>
                                <Then>
                                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC Update: Success! Updated to latest version: #adobe_reader_version#" />
                                  </Statement>
                                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppUpdate AdobeAcrobatReaderDC" />
                                  </Statement>
                                </Then>
                                <Else>
                                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC: Failed!  Not present after update. Evaluate the Agent Procedure log and MSInstaller Event log on the system." />
                                  </Statement>
                                </Else>
                              </If>
                            </Then>
                            <Else>
                              <Statement description="This will incicate that the WMI query up in line 33 did not execute correctly." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC WMI query did not execute correctly. No  result file detected." />
                              </Statement>
                            </Else>
                          </If>
                        </Else>
                      </If>
                    </Then>
                    <Else>
                      <Statement description="This is the ELSE statement associated with IF waaaaay up on line 17." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC not detected on the system. No action taken." />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="This will incicate that the WMI query up in line 10 did not execute correctly." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC WMI query did not execute correctly. No  result file detected." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\adobe_reader_DC_version_utf.result" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Adobe Acrobat Reader DC - Language Independent - Update To Latest. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Application Update - Windows - Java 8 32bit - Update To Latest" treePres="3" id="2124712910" folderId="919000816493767" treeFullPath="Upstream Kaseya Power Pack.3rd Party Application Mgmnt 2018-12-19.Windows.Application Update.Language Independent">
            <Body description="">
              <Statement description="Procedure description: Update existing Java 8 32Bit version to latest. Removes any older Java 8 32Bit version before deployment.&#xD;&#xA;Kaseya customer value: Procedure to secure clients with the latest software.&#xD;&#xA;End user value: Limiting the risks for unwanted external Java related attacks, downtime and data loss.&#xD;&#xA;Dependencies: Windows OS. Java 8 32Bit present.&#xD;&#xA;Usage: Schedule or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Last change: 2018-05-04&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Before we deploy, let's audit the system for any Java 8 32Bit present and do some cleanup." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%8%Update%'&quot; get Name, Version /Format:value &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt;#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
              </Statement>
              <If description="Is any older Java 8 32Bit version detected? If so, let's go on with updating to latest.">
                <Condition name="TestFile">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                  <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update" />
                </Condition>
                <Then>
                  <If description="IMPORTANT NOTE: When detected, is it the latest version? You have to change Does Not Contain &quot;Name=Java 8 Update XXX&quot; to new version when released.">
                    <Condition name="TestFile">
                      <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                      <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 171" />
                    </Condition>
                    <Then>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Older Java 8 version (both 32 and 64 bit) detected and will be removed. #java_version#" />
                      </Statement>
                      <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;name like 'Java%8%Update%'&quot; call uninstall /nointeractive" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Older Java 8 versions (both 32 and 64 bit) removed (if present)." />
                      </Statement>
                      <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: The update part." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Downloading latest Java 8 32Bit installer." />
                      </Statement>
                      <Statement description="IMPORTANT NOTE: In this example we use our Dropbox for MSI file distribution. Java.com does not post the MSI files, but feel free to download the EXE and extraxt the MSI if you do not trust our links." name="GetURL" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="URL" value="http://javadl.oracle.com/webapps/download/AutoDL?BundleId=233170_512cd62ec5174c3487ac17c61aaa89e8" />
                        <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\java32.exe" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                      <Statement description="IMPORTANT NOTE: If you do not trust the MSI installers provided above you can always create your own by following this guide: http://www.74k.org/extracting-java-msi-from-java-exe" name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Update begins." />
                      </Statement>
                      <Statement name="ExecuteFile" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java32.exe" />
                        <Parameter xsi:type="StringParameter" name="Arguments" value="/s REBOOT=Suppress /L #vAgentConfiguration.agentTempDir#\java8-32bit-install.log" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                      </Statement>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Update completed. If needed, evaluate the log at &quot;#vAgentConfiguration.agentTempDir#\java8-32bit-install.log&quot;." />
                      </Statement>
                      <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
                      </Statement>
                      <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                      </Statement>
                      <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java32.exe" />
                      </Statement>
                      <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: After deployment, let's audit the system for latest Java 8 32Bit present for compliance." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="wmic product where &quot;Name like 'Java%8%Update%'&quot; get Name, Version /Format:value &gt;&gt;#vAgentConfiguration.agentTempDir#\java_version.result" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement description="We have to convert the above result to a encoding Kaseya understands in order to use it as a variable." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\java_version.result &gt;&gt; #vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                      </Statement>
                      <Statement description="We can now get the content of the UTF encoded file and put it in a variable. " name="GetVariable" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                        <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                        <Parameter xsi:type="StringParameter" name="VariableName" value="java_version" />
                      </Statement>
                      <If description="IMPORTANT NOTE: You have to change Contain &quot;Name=Java 8 Update XXX&quot; to new version when released.">
                        <Condition name="TestFile">
                          <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
                          <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                          <Parameter xsi:type="StringParameter" name="Value" value="Name=Java 8 Update 171" />
                        </Condition>
                        <Then>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Success! #java_version#" />
                          </Statement>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Hashtag: AppUpdate Java8" />
                          </Statement>
                        </Then>
                        <Else>
                          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Failed! Latest Java 8 32Bit not detected. Evaluate the log at &quot;#vAgentConfiguration.agentTempDir#\java8-32bit-install.log&quot;." />
                          </Statement>
                        </Else>
                      </If>
                    </Then>
                    <Else>
                      <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                        <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Java 8 32bit detected AND latest version. Nothing to do. #java_version#" />
                      </Statement>
                    </Else>
                  </If>
                </Then>
                <Else>
                  <Statement description="If no Java 8 32Bit version is detected in Stage 1, we take a note of that in the Agent Procedure Log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: Java 8 32bit not detected. Nothing to do." />
                  </Statement>
                </Else>
              </If>
              <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version.result" />
              </Statement>
              <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\java_version_utf.result" />
              </Statement>
              <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Java 8 32Bit update: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
      </Folder>
    </Folder>
  </Folder>
</ScriptExport>

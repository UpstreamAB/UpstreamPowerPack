<?xml version="1.0" encoding="utf-8"?>
<ScriptExport xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.kaseya.com/vsa/2008/12/Scripting">
  <Folder name="OS Patch and System Mgmnt 2018-10-26" treePres="3">
    <Folder name="Linux" treePres="3">
      <Folder name="Patch Management" treePres="3">
        <Procedure name="Patch Mgmnt - Linux - Debian Fork - Patch And Upgrade System" treePres="3" id="1948884458" folderId="788886997098515" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Linux.Patch Management">
          <Body description="Description: Upgrades Debian based Linux systems with the latest software and patches.&#xA;&#xA;Kaseya customer value: Procedure to secure and enhance Linux servers and clients with the latest software and functions.&#xA;&#xA;End user value: Procedure to secure and enhance Linux servers and clients with the latest software and functions.&#xA;&#xA;Dependencies: Debian based Linux systems.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Linux patch result:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="Let's update the list of Linux packages. This will not patch or upgrade the system." name="ExecuteShellCommand" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Command" value="apt-get update" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Comment" value="Linux package list updated." />
            </Statement>
            <Statement description="Let's upgrade the Linux system with the latest packages. All available packages will get updated." name="ExecuteShellCommand" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Command" value="apt-get upgrade -y -q &gt;&gt; #vAgentConfiguration.agentTempDir#/linux-upgrade.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#/linux-upgrade.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="linux-upgrade" />
            </Statement>
            <Statement name="DeleteFile" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/linux-upgrade.result" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Linux patch result: #linux-upgrade#" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Patch Mgmnt - Linux - Debian Fork - Update The Package List" treePres="3" id="991089240" folderId="788886997098515" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Linux.Patch Management">
          <Body description="Description: Updates the application list for Debian based Linux systems.&#xA;&#xA;Kaseya customer value: Procedure to secure and enhance Linux servers and clients with the latest software and functions.&#xA;&#xA;End user value: Procedure to secure and enhance Linux servers and clients with the latest software and functions.&#xA;&#xA;Dependencies: Debian based Linux systems.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Linux package list updated.&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="Let's update the list of Linux packages. This will not patch or upgrade the system." name="ExecuteShellCommand" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Command" value="apt-get update" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Linux">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Linux package list updated." />
            </Statement>
          </Body>
        </Procedure>
      </Folder>
    </Folder>
    <Folder name="Mac" treePres="3">
      <Folder name="Patch Management" treePres="3">
        <Procedure name="Patch Mgmnt - Mac OS X - Download Patches" treePres="3" id="295607746" folderId="742658804097519" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Mac.Patch Management">
          <Body description="Description: Downloads the available software updates locally for Mac OS X.&#xA;&#xA;Kaseya customer value: Procedure to secure and enhance Mac OS X servers and clients with the latest software and functions.&#xA;&#xA;End user value: Procedure to secure and enhance Mac OS X servers and clients with the latest software and functions.&#xA;&#xA;Dependencies: Mac OS X.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Mac OS X software download:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="softwareupdate -l &gt;&gt; #agentpath#\softwarelist.txt" name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Command" value="softwareupdate -d &gt;&gt; #vAgentConfiguration.agentTempDir#/osx-update-download.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Create a named procedure variable and assign a value retrieved from the managed machine by the agent." name="GetVariable" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#/osx-update-download.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="osx-update-download" />
            </Statement>
            <Statement description="Delete the specified file - full path to the filename required." name="DeleteFile" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/osx-update-download.result" />
            </Statement>
            <Statement description="Write an Entry into the Procedure Log" name="WriteScriptLogEntry" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Comment" value="Mac OS X software download: #osx-update-download#" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Patch Mgmnt - Mac OS X - List Missing Patches" treePres="3" id="363391576" folderId="742658804097519" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Mac.Patch Management">
          <Body description="Description: List the available software updates for Mac OS X.&#xA;&#xA;Kaseya customer value: Procedure to secure and enhance Mac OS X servers and clients with the latest software and functions.&#xA;&#xA;End user value: Procedure to secure and enhance Mac OS X servers and clients with the latest software and functions.&#xA;&#xA;Dependencies: Mac OS X.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Mac OS X software list:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Command" value="softwareupdate -l &gt;&gt; #vAgentConfiguration.agentTempDir#/osx-update-update-list.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Pause this procedure for N seconds to give a previous action time to complete." name="PauseScript" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="60" />
            </Statement>
            <Statement description="Create a named procedure variable and assign a value retrieved from the managed machine by the agent." name="GetVariable" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#/osx-update-update-list.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="osx-update-list" />
            </Statement>
            <Statement description="Delete the specified file - full path to the filename required." name="DeleteFile" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/osx-update-update-list.result" />
            </Statement>
            <Statement description="Write an Entry into the Procedure Log" name="WriteScriptLogEntry" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Comment" value="Mac OS X software list: #osx-update-list#" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Patch Mgmnt - Mac OS X - Turn Off Automatic Updates" treePres="3" id="1365799115" folderId="742658804097519" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Mac.Patch Management">
          <Body description="Description: Turn off the automatic software updates for Mac OS X.&#xA;&#xA;Kaseya customer value: Procedure reduce unwanted support issues regarding updating Mac OS X.&#xA;&#xA;End user value: Procedure to reduce unwanted update spalsh screen Mac OS X.&#xA;&#xA;Dependencies: Mac OS X.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Mac OS X automatic update:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="softwareupdate -l &gt;&gt; #agentpath#\softwarelist.txt" name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Command" value="softwareupdate --schedule off &gt;&gt; #vAgentConfiguration.agentTempDir#/automatic-update-check.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Create a named procedure variable and assign a value retrieved from the managed machine by the agent." name="GetVariable" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#/automatic-update-check.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="automatic-update-check" />
            </Statement>
            <Statement description="Delete the specified file - full path to the filename required." name="DeleteFile" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/automatic-update-check.result" />
            </Statement>
            <Statement description="Write an Entry into the Procedure Log" name="WriteScriptLogEntry" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Comment" value="Mac OS X automatic update: #automatic-update-check#" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Patch Mgmnt - Mac OS X - Turn On Automatic Updates" treePres="3" id="408003897" folderId="742658804097519" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Mac.Patch Management">
          <Body description="Description: Turn on the automatic software updates for Mac OS X.&#xA;&#xA;Kaseya customer value: Procedure reset the automatic software update to on in Mac OS X.&#xA;&#xA;End user value: Procedure to let the end user control automatic software update to on in Mac OS X.&#xA;&#xA;Dependencies: Mac OS X.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Mac OS X automatic update:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="softwareupdate -l &gt;&gt; #agentpath#\softwarelist.txt" name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Command" value="softwareupdate --schedule on &gt;&gt; #vAgentConfiguration.agentTempDir#/automatic-update-check.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Create a named procedure variable and assign a value retrieved from the managed machine by the agent." name="GetVariable" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#/automatic-update-check.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="automatic-update-check" />
            </Statement>
            <Statement description="Delete the specified file - full path to the filename required." name="DeleteFile" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/automatic-update-check.result" />
            </Statement>
            <Statement description="Write an Entry into the Procedure Log" name="WriteScriptLogEntry" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Comment" value="#automatic-update-check#" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Patch Mgmnt - Mac OS X - Update System" treePres="3" id="176120695" folderId="742658804097519" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Mac.Patch Management">
          <Body description="Description: Updates the available software updates for Mac OS X. No forced reboot, but reboot should be part of the process.&#xA;&#xA;Kaseya customer value: Procedure to secure and enhance Mac OS X servers and clients with the latest software and functions.&#xA;&#xA;End user value: Procedure to secure and enhance Mac OS X servers and clients with the latest software and functions.&#xA;&#xA;Dependencies: Mac OS X.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;Mac OS X software update:&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="softwareupdate -l &gt;&gt; #agentpath#\softwarelist.txt" name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Command" value="softwareupdate -i -a &gt;&gt; #vAgentConfiguration.agentTempDir#/osx-update.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Create a named procedure variable and assign a value retrieved from the managed machine by the agent." name="GetVariable" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#/osx-update.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="osx-update" />
            </Statement>
            <Statement description="Delete the specified file - full path to the filename required." name="DeleteFile" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#/osx-update.result" />
            </Statement>
            <Statement description="Write an Entry into the Procedure Log" name="WriteScriptLogEntry" continueOnFail="false" osType="MacOS">
              <Parameter xsi:type="StringParameter" name="Comment" value="Mac OS X software update: #osx-update#" />
            </Statement>
          </Body>
        </Procedure>
      </Folder>
      <Procedure name="Mac OS X - Install Powershell" treePres="3" id="1131345057" folderId="666945502286285" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Mac">
        <Body description="">
          <Statement description="Procedure description: Enable the IT Glue Chrome plug-in ona computer.&#xD;&#xA;Kaseya customer value: Speeds up password related tech supprot.&#xD;&#xA;End user value: Speeds up password related tech supprot.&#xD;&#xA;Dependencies: Windows OS, Chrome installed.&#xD;&#xA;Usage: Run Once.&#xD;&#xA;Report options: None.&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="ExecuteShellCommand" continueOnFail="false" osType="MacOS">
            <Parameter xsi:type="StringParameter" name="Command" value="brew cask install powershell" />
            <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
            <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
          </Statement>
          <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="None">
            <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Install IT Glue Chrome Plug-In: The Agent Procedure hit the last row and will now exit." />
          </Statement>
        </Body>
      </Procedure>
    </Folder>
    <Folder name="Windows" treePres="3">
      <Folder name="Patch Management" treePres="3">
        <Procedure name="Patch Mgmnt - Windows - Patch Windows From Command Line" treePres="3" id="2052241325" folderId="507878404999095" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.Patch Management">
          <Body description="">
            <If description="Procedure description: Execute instant Windows update from the commandline. Respect to Flemming Varmer at ABC-Deploy.com for this awesome freeware!&#xD;&#xA;Kaseya customer value: Kaseyas automatic patch schedule may take some time to finish. When in a support call or for quick patch results, run this procedure instead.&#xD;&#xA;End user value: Get the latest Windows patches now, not later.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Recurring schedule or Run Now. Run Patch Scan afterwords.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\abc-update\abc-update.exe" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetURL" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="URL" value="http://abc-deploy.com/Files/ABC-Update.zip" />
                  <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\ABC-Update.zip" />
                  <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                </Statement>
                <Statement name="Unzip file" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="#vAgentConfiguration.agentTempDir#\ABC-Update.zip" />
                  <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\abc-update" />
                  <Parameter xsi:type="StringParameter" name="Parameter3" value="True" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update EULA.pdf" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update GUI.exe" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update GUI.exe.config" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\abc-update.exe.config" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update.pdf" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update.zip" />
                </Statement>
              </Then>
            </If>
            <Statement description="The ABC Update commands can be views here: http://abc-deploy.com/files/abc" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\abc-update\abc-update.exe /A:Install /R:N /Log:#vAgentConfiguration.agentTempDir#\WinUpdate-Commandline.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\WinUpdate-Commandline.log" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="WinUpdate_Commandline_results" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Patch From Command Line: #WinUpdate_Commandline_results#" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Patch From Command Line: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Patch Mgmnt - Windows - Update Drivers From Command Line" treePres="3" id="136650890" folderId="507878404999095" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.Patch Management">
          <Body description="">
            <If description="Procedure description: Download and install available Windows drivers from Windows Update. This Kaseya can not do within the Patch engine.&#xD;&#xA;Kaseya customer value: Ensure all drivers are up to date for best system performance and troubleshooting.&#xD;&#xA;End user value: Best possible system performance.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Recurring schedule or Run Now.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Let's start by downloading a freeware tool. Respect to Flemming Varmer at http://abc-deploy.com/abc-update/History">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\abc-update\abc-update.exe" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetURL" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="URL" value="http://abc-deploy.com/Files/ABC-Update.zip" />
                  <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\ABC-Update.zip" />
                  <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                </Statement>
                <Statement name="Unzip file" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="#vAgentConfiguration.agentTempDir#\ABC-Update.zip" />
                  <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\abc-update" />
                  <Parameter xsi:type="StringParameter" name="Parameter3" value="True" />
                </Statement>
                <Statement description="We only need the ABC-Update.exe, so let's clean up the rest." name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update EULA.pdf" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update GUI.exe" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update GUI.exe.config" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\abc-update.exe.config" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update\ABC-Update.pdf" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ABC-Update.zip" />
                </Statement>
              </Then>
            </If>
            <Statement description="The ABC Update commands can be views here: http://abc-deploy.com/files/abc-update.pdf" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\abc-update\abc-update.exe /A:Install /Input:Exclude /T:Driver /R:N /Log:#vAgentConfiguration.agentTempDir#\WinDriversUpdate-Commandline.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\WinDriversUpdate-Commandline.log" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="WinDriversUpdate_Commandline_results" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: #WinDriversUpdate_Commandline_results#" />
            </Statement>
          </Body>
        </Procedure>
      </Folder>
      <Folder name="System Management" treePres="3">
        <Folder name="Power And Sleep Settings" treePres="3">
          <Procedure name="Sys Mgmnt - Windows - Power And Sleep Settings - Disable Hibernation" treePres="3" id="525374452" folderId="340313157597702" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management.Power And Sleep Settings">
            <Body description="Description: Run any shell command directly from the Kaseya Agent Procedure with interactive input. Great for testing ping or doing any command line related test on one or more machines at once.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Kaseya customer value: A quick way to test or do changes on one or many machines at once without having to enter LiveConnect or remote control.&#xA;&#xA;End user value: A quick way to get help with various tasks in system management.&#xA;&#xA;Usage: Execute the procedure at any time.&#xA;&#xA;Report Parameters: Procedure Log, &quot;Results from shell command:&quot;&#xA; &#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot; No support included.">
              <Statement description="Procedure description: Disable hibernation in Energy Settings.&#xD;&#xA;Kaseya customer value: Procedure to disable hibernation.&#xD;&#xA;End user value: Remove unwantend hibernation settings on any machine.&#xD;&#xA;Dependencies: Windows OS. Edit the version string to latest for compliance check. Follow the important notes.&#xD;&#xA;Usage: Schedule or Run Now.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se Last change: 2017-09-28&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -h off" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Power And Sleep: Hibernation is now disabled." />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Power And Sleep: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
          <Procedure name="Sys Mgmnt - Windows - Power And Sleep Settings - Energy Policy Example" treePres="3" id="1715052872" folderId="340313157597702" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management.Power And Sleep Settings">
            <Body description="">
              <Statement description="Procedure description: Enable and enforce a Energy Settings policy&#xD;&#xA;Kaseya customer value: Procedure to enforce a Enery Setting policy.&#xD;&#xA;End user value: Enamble a Energy Settign policy for &quot;green IT&quot;.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule or Run Now.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se Last change: 2017-09-28&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Read more here: https://technet.microsoft.com/en-us/library/cc748940(v=ws.10).aspx&#xD;&#xA;Screen will turn off after 5 minutes when on battery power" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -change -monitor-timeout-dc 5" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Screen will turn off after 5 minutes when plugged in." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -change -monitor-timeout-ac 10" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Computer will sleep after 10 minutes when on battery power." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -change -standby-timeout-dc 15" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Computer will sleep after 30 minutes when plugged in." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -change -standby-timeout-ac 30" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Computer will hibernate after 20 minutes when on battery power." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -change -hibernate -timeout-dc 20" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement description="Computer will hibernate after 60 minutes when plugged in." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Command" value="powercfg -change -hibernate -timeout-ac 60" />
                <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Power And Sleep: Energy Policy Example applied." />
              </Statement>
              <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Power And Sleep: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Folder name="Windows TS Specific" treePres="3">
          <Procedure name="Sys Mgmnt - Windows - Set TS Servers To EXECUTE Mode" treePres="3" id="1752574293" folderId="839052388369595" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management.Windows TS Specific">
            <Body description="">
              <If description="">
                <Condition name="ServiceIsRunning">
                  <Parameter xsi:type="StringParameter" name="ServiceName" value="TermService" />
                </Condition>
                <Then>
                  <Statement description="Execute shell command and verify on Windows 2003 Servers with running TermServices." name="ExecuteShellCommand" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /execute" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /query &gt;&gt;#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="GetVariable" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="tsinstallmode" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TS InstallMode Swtiched to: #tsinstallmode#" />
                  </Statement>
                  <Statement description="Execute shell command and verify on Windows 2008 Servers with running TermServices." name="ExecuteShellCommand" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /execute" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /query &gt;&gt;#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="GetVariable" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="tsinstallmode" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTERAM: TS InstallMode Swtiched to: #tsinstallmode#" />
                  </Statement>
                  <Statement description="Execute shell command and verify on Windows 2012 Servers with running TermServices." name="ExecuteShellCommand" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /execute" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /query &gt;&gt;#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="GetVariable" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="tsinstallmode" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TS InstallMode Swtiched to: #tsinstallmode#" />
                  </Statement>
                </Then>
              </If>
            </Body>
          </Procedure>
          <Procedure name="Sys Mgmnt - Windows - Set TS Servers To INSTALL Mode" treePres="3" id="1820358123" folderId="839052388369595" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management.Windows TS Specific">
            <Body description="">
              <If description="">
                <Condition name="ServiceIsRunning">
                  <Parameter xsi:type="StringParameter" name="ServiceName" value="TermService" />
                </Condition>
                <Then>
                  <Statement description="Execute shell command and verify on Windows 2003 Servers with running TermServices." name="ExecuteShellCommand" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /install" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /query &gt;&gt;#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="GetVariable" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="tsinstallmode" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="2003">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TS InstallMode Swtiched to: #tsinstallmode#" />
                  </Statement>
                  <Statement description="Execute shell command and verify on Windows 2008 Servers with running TermServices." name="ExecuteShellCommand" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /install" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /query &gt;&gt;#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="GetVariable" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="tsinstallmode" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="2008">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TS InstallMode Swtiched to: #tsinstallmode#" />
                  </Statement>
                  <Statement description="Execute shell command and verify on Windows 2012 Servers with running TermServices." name="ExecuteShellCommand" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /install" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="ExecuteShellCommand" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Command" value="change user /query &gt;&gt;#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                    <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                  </Statement>
                  <Statement name="GetVariable" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                    <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                    <Parameter xsi:type="StringParameter" name="VariableName" value="tsinstallmode" />
                  </Statement>
                  <Statement name="DeleteFile" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\tsinstallmode.result" />
                  </Statement>
                  <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="2012">
                    <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: TS InstallMode Swtiched to: #tsinstallmode#" />
                  </Statement>
                </Then>
              </If>
            </Body>
          </Procedure>
          <Procedure name="Sys Mgmnt - Windows - Set TS Shadowing For KRC ON" treePres="3" id="862562905" folderId="839052388369595" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management.Windows TS Specific">
            <Body description="">
              <Statement description="This procedure will set Terminal Service servers to allow shadowing of session with Kaseya remote control&#xD;&#xA;Kaseya Customer Value: removes the need to change this manually&#xD;&#xA;End User Value: Allows support of TS sessions via kaseya&#xD;&#xA;Dependencies: WIndows OS&#xD;&#xA;Report options: Agent Procedure log. Look for &quot;UPSTREAM: TS Shadow Enabled&quot;&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;---------------------------------------------------------------------------------------------------------------------------&#xD;&#xA;registry 32 bit - 2 is the correct setting 1 and 0 both will not work with kaseya" name="SetRegistryValue" continueOnFail="false">
                <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\shadow" />
                <Parameter xsi:type="StringParameter" name="Value" value="2" />
                <Parameter xsi:type="EnumParameter" name="DataType" value="Integer" />
              </Statement>
              <Statement description="registry 64 bit - 2 is the correct setting 1 and 0 both will not work with kaseya" name="SetRegistryValue64" continueOnFail="false">
                <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\shadow" />
                <Parameter xsi:type="StringParameter" name="Value" value="2" />
                <Parameter xsi:type="EnumParameter" name="DataType" value="Integer" />
              </Statement>
            </Body>
          </Procedure>
        </Folder>
        <Procedure name="Sys Mgmnt -  Windows - Reset Windows Update Cache" treePres="3" id="1745483393" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Procedure description: To resolve lingering patch install issues from other RMM/management suites.&#xD;&#xA;Kaseya customer value: Procedure to on-board customers and ensure Patch Mgmnt will be properly automated after moving to Kaseya from another RMM/Mgmnt tool.&#xD;&#xA;End user value: Systems get patched.&#xD;&#xA;Dependencies: Windows OS. Reboot required.&#xD;&#xA;Usage: Schedule Once or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-06-20&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;First we stop four services to allow several files and settings to be reset" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net stop bits" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net stop wuauserv" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net stop appidsvc" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net stop cryptsvc" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
            </Statement>
            <Statement description="Delete the qmgr*.dat files" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="Del &quot;%ALLUSERSPROFILE%\Application Data\Microsoft\Network\Downloader\qmgr*.dat&quot;" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Rename the softare distribution folders backup copies" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="Ren %systemroot%\SoftwareDistribution SoftwareDistribution.bak" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="Ren %systemroot%\system32\catroot2 catroot2.bak" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="5" />
            </Statement>
            <Statement description="Reset the BITS service and the Windows Update service to the default security descriptor." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="sc.exe sdset bits D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;PU)" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="sc.exe sdset wuauserv D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;PU)" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="5" />
            </Statement>
            <Statement description="Reregister the BITS files and the Windows Update files" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s atl.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s urlmon.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s mshtml.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s shdocvw.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s browseui.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s jscript.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s vbscript.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s scrrun.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s msxml.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s msxml3.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s msxml6.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s actxprxy.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s softpub.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wintrust.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s dssenh.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s rsaenh.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s gpkcsp.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s sccbase.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s slbcsp.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s cryptdlg.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s oleaut32.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s ole32.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s shell32.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s initpki.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wuapi.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wuaueng.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wuaueng1.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wucltui.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wups.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wups2.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wuweb.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s qmgr.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s qmgrprxy.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wucltux.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s muweb.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="regsvr32 /s wuwebv.dll" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Reset Winsock - requires restart" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="netsh winsock reset" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Reset Proxy" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="netsh winhttp reset proxy" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Restart the stopped services" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net start bits" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="10" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net start wuauserv" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="10" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net start appidsvc" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="10" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="net start cryptsvc" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reset Windows Update Cache: Update has been reset, please restart this machine." />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reset Windows Update Cache: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Add SQL Tcp Port 1433 Allowed Firewall Rule Example" treePres="3" id="1558212512" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Command" value="netsh advfirewall firewall add rule name = SQLPort dir = in protocol = tcp action = allow localport = 1433 remoteip = localsubnet profile = DOMAIN" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Create 3GB Dummy File Example" treePres="3" id="1625996342" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Procedure description: Creates a 3GB dummy file in the Kworking folder.&#xD;&#xA;Kaseya customer value: Forced Low Disk Alerting and simulations.&#xD;&#xA;End user value: None.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="fsutil file createnew #vAgentConfiguration.agentTempDir#\dummy.file 3221225472" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <If description="">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value=" #vAgentConfiguration.agentTempDir#\dummy.file" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetVariable" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="EnumParameter" name="VariableType" value="FileSize" />
                  <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\dummy.file " />
                  <Parameter xsi:type="StringParameter" name="VariableName" value="#FileSize#" />
                </Statement>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Dummy file: File created. Size: ##FileSize##" />
                </Statement>
              </Then>
            </If>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Create Windows Application Event Example" treePres="3" id="480930243" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement name="Create Event Log Entry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="This is a test" />
              <Parameter xsi:type="EnumParameter" name="Parameter2" value="Information" />
              <Parameter xsi:type="EnumParameter" name="Parameter3" value="Application" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Delete User Profiles Older Than 90 Days" treePres="3" id="900084326" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <If description="Procedure description: Procedure to do a standardized disk cleanup.&#xD;&#xA;Kaseya customer value: Speed up the troubleshooting an maintenance work.&#xD;&#xA;End user value: Assure that the system is healthy.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Report options: Agent Procedure log. Look for &quot;UPSTREAM: Disk Cleanup:&quot; statements.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-09-28&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;First we need a command line tool. Download if missing.">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\delprof2.exe" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetURL" continueOnFail="false" osType="None">
                  <Parameter xsi:type="StringParameter" name="URL" value="https://upstream.dattodrive.com/index.php/s/aUGgf7A4Vyv5dgR/download" />
                  <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\sfk.exe" />
                  <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                </Statement>
              </Then>
            </If>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\sfk space c: &gt;&gt;#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="free_disk_on_c" />
            </Statement>
            <Statement description="Start documenting the progress in disk_cleanup.log" name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Beginning Disk Cleanup. This log will show all the cleanup steps by order of execution." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="Disk available before Disk Cleanup on C: #free_disk_on_c#" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false">
              <Parameter xsi:type="StringParameter" name="Command" value="type &quot;Status before Disk Cleanup: #free_disk_on_c#&quot;&quot; &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="User" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Status before Disk Cleanup: #free_disk_on_c#" />
            </Statement>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Disk cleanup&#xD;&#xA;Delete user profiles older than 90 days." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Remove User Profiels older not used within 90 days." />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: UPSTREAM: Disk Cleanup: Remove older User Profiels not used within 90 days.cleanup steps by order of execution." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\delprof2 /u /d:90 /ed:Admin*,Default,Public* /l &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Remove superseded and unused system files from an online image with DISM command." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to a DISM cleanup. Continuing with other Disk Cleanup tasks." />
            </Statement>
            <If description="">
              <Condition name="Windows 32 or 64 Bit Check">
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
              </Condition>
              <Then>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="dism /online /Cleanup-Image /StartComponentCleanup &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="True" />
                </Statement>
              </Then>
              <Else>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="dism /online /Cleanup-Image /StartComponentCleanup &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
              </Else>
            </If>
            <Statement description="Remove C:\Windows\Temp files." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files and sub-folders in &quot;C:\Windows\Temp\&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del C:\Windows\Temp\* /Q /S &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Remove CBS logs in C:\Windows\Logs\CBS." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in &quot;C:\Windows\Logs\CBS\&quot;." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del C:\Windows\Logs\CBS\* /Q /S &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="PatchCache clean up." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in &quot;c:\Windows\installer\$PatchCache$\&quot;." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <If description="">
              <Condition name="ServiceIsRunning">
                <Parameter xsi:type="StringParameter" name="ServiceName" value="msiserver" />
              </Condition>
              <Then>
                <Statement name="Stop Windows Service" continueOnFail="true">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="msiserver" />
                </Statement>
                <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
                </Statement>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to remove &quot;%WINDIR%\Installer\$PatchCache$*&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\Installer\$PatchCache$\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="Start Windows Service" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="msiserver" />
                  <Parameter xsi:type="StringParameter" name="Parameter2" value="False" />
                </Statement>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to clean &quot;%WINDIR%\Installer\$PatchCache$&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\Installer\$PatchCache$\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
              </Else>
            </If>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\Windows\SoftwareDistribution\Download\&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <If description="">
              <Condition name="ServiceIsRunning">
                <Parameter xsi:type="StringParameter" name="ServiceName" value="wuauserv" />
              </Condition>
              <Then>
                <Statement name="Stop Windows Service" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="wuauserv" />
                </Statement>
                <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
                </Statement>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to remove &quot;%WINDIR%\SoftwareDistribution\Download&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\SoftwareDistribution\Download\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="Start Windows Service" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="wuauserv" />
                  <Parameter xsi:type="StringParameter" name="Parameter2" value="False" />
                </Statement>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to remove &quot;%WINDIR%\SoftwareDistribution\Download&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\SoftwareDistribution\Download\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
              </Else>
            </If>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\dell&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del c:\dell\* /q /s" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="rd c:\dell /S /Q" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\lenovo&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del c:\lenovo\* /q /s" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="rd c:\lenovo /S /Q" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\hp&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del c:\hp\* /q /s" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="rd c:\hp /S /Q" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: Post Disk Cleanup check for available disk space." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Disk Cleanup complete." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="Disk available before Disk Cleanup on C: #free_disk_on_c#" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\sfk space c: &gt;&gt;#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="free_disk_on_c" />
            </Statement>
            <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="Disk available after Disk Cleanup on C: #free_disk_on_c#" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Status after Disk Cleanup: #free_disk_on_c#" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Disable RDP" treePres="3" id="1783004814" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="Description: This procedure will disable RDP for remote control.&#xA;&#xA;Kaseya customer value: This procedure disables RDP in the registry and disables RDP connections from Kaseya Live Connect. Security, support and control.&#xA;&#xA;End user value: Security, support and control.&#xA;&#xA;Dependencies: Windows.&#xA;&#xA;Usage: Execute the procedure at any time.&#xA;&#xA;Report options: Procedure Log, content: &quot;RDP is now disabled.&quot;&#xA; &#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot; No support included.">
            <Statement description="fDenyTSConnections set to 0 will enable RDP." name="SetRegistryValue" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections" />
              <Parameter xsi:type="StringParameter" name="Value" value="0" />
              <Parameter xsi:type="EnumParameter" name="DataType" value="Integer" />
            </Statement>
            <Statement description="Writes a procedure log entry." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: RDP is now disabled." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Disk Cleanup (With Extensive Logging)" treePres="3" id="825209596" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <If description="Procedure description: Procedure to do a standardized disk cleanup.&#xD;&#xA;Kaseya customer value: Speed up the troubleshooting and maintenance work.&#xD;&#xA;End user value: Assure that the system is healthy.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Report options: Agent Procedure log. Look for &quot;UPSTREAM: Disk Cleanup:&quot; statements.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2018-11-21&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;If previous Disk Cleanup log file exists, let's remove it.">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                </Statement>
              </Then>
            </If>
            <If description="First we need some command line tools. Download if missing.">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\sfk.exe" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetURL" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="URL" value="https://upstream.dattodrive.com/index.php/s/aUGgf7A4Vyv5dgR/download" />
                  <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\sfk.exe" />
                  <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                </Statement>
              </Then>
            </If>
            <If description="">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\delprof2.exe" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetURL" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="URL" value="https://upstream.dattodrive.com/index.php/s/dwE362qzhvPQxsw/download" />
                  <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\delprof2.exe" />
                  <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                </Statement>
              </Then>
            </If>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Check for available disk space." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\sfk space c: &gt;&gt;#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="free_disk_on_c" />
            </Statement>
            <Statement description="Start documenting the progress in disk_cleanup.log" name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Beginning Disk Cleanup. This log will show all the cleanup steps by order of execution." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="Disk available before Disk Cleanup on C: #free_disk_on_c#" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false">
              <Parameter xsi:type="StringParameter" name="Command" value="type &quot;Status before Disk Cleanup: #free_disk_on_c#&quot;&quot; &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="User" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Status before Disk Cleanup: #free_disk_on_c#" />
            </Statement>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Disk cleanup&#xD;&#xA;Delete user profiles older than 90 days." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Remove User Profiles older not used within 90 days." />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Disk Cleanup: Remove older User Profiels not used within 90 days." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\delprof2 /u /d:90 /ed:Admin*,Default,Public* &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to a DISM cleanup. Continuing with other Disk Cleanup tasks." />
            </Statement>
            <Statement description="Remove superseded and unused system files from an online image with DISM command." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Remove superseded and unused system files from an online image with DISM command." />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <If description="">
              <Condition name="Windows 32 or 64 Bit Check">
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
              </Condition>
              <Then>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="dism /online /Cleanup-Image /StartComponentCleanup &gt;&gt;#vAgentConfiguration.agentTempDir#\dism_cleanup.result" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="True" />
                </Statement>
              </Then>
              <Else>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="dism /online /Cleanup-Image /StartComponentCleanup &gt;&gt;#vAgentConfiguration.agentTempDir#\dism_cleanup.result" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
              </Else>
            </If>
            <If description="">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\dism_cleanup.result" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                <Parameter xsi:type="StringParameter" name="Value" value="successfully" />
              </Condition>
              <Then>
                <If description="">
                  <Condition name="TestFile">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\dism_cleanup.result" />
                    <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                    <Parameter xsi:type="StringParameter" name="Value" value="successfully" />
                  </Condition>
                  <Then>
                    <Statement name="Write text to file" continueOnFail="false" osType="Windows">
                      <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: DISM cleanup success. Continuing with other cleanup tasks." />
                      <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                      <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
                    </Statement>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: DISM cleanup success. Continuing with other Disk Cleanup tasks." />
                    </Statement>
                  </Then>
                  <Else>
                    <Statement name="Write text to file" continueOnFail="false" osType="Windows">
                      <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: DISM cleanup failed. Continuing with other cleanup tasks." />
                      <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                      <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
                    </Statement>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: DISM cleanup failed. Continuing with other Disk Cleanup tasks." />
                    </Statement>
                  </Else>
                </If>
              </Then>
            </If>
            <Statement description="Remove C:\Windows\Temp files." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files and sub-folders in &quot;C:\Windows\Temp\&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del C:\Windows\Temp\* /Q /S &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="Remove CBS logs in C:\Windows\Logs\CBS." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in &quot;C:\Windows\Logs\CBS\&quot;." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="del C:\Windows\Logs\CBS\* /Q /S &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="PatchCache clean up." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in &quot;c:\Windows\installer\$PatchCache$\&quot;." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <If description="">
              <Condition name="ServiceIsRunning">
                <Parameter xsi:type="StringParameter" name="ServiceName" value="msiserver" />
              </Condition>
              <Then>
                <Statement name="Stop Windows Service" continueOnFail="true">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="msiserver" />
                </Statement>
                <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
                </Statement>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to remove &quot;%WINDIR%\Installer\$PatchCache$*&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\Installer\$PatchCache$\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="Start Windows Service" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="msiserver" />
                  <Parameter xsi:type="StringParameter" name="Parameter2" value="False" />
                </Statement>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to clean &quot;%WINDIR%\Installer\$PatchCache$&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\Installer\$PatchCache$\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
              </Else>
            </If>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\Windows\SoftwareDistribution\Download\&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <If description="">
              <Condition name="ServiceIsRunning">
                <Parameter xsi:type="StringParameter" name="ServiceName" value="wuauserv" />
              </Condition>
              <Then>
                <Statement name="Stop Windows Service" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="wuauserv" />
                </Statement>
                <Statement name="PauseScript" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="IntegerParameter" name="Seconds" value="15" />
                </Statement>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to remove &quot;%WINDIR%\SoftwareDistribution\Download&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\SoftwareDistribution\Download\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="Start Windows Service" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Parameter1" value="wuauserv" />
                  <Parameter xsi:type="StringParameter" name="Parameter2" value="False" />
                </Statement>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Attempting to remove &quot;%WINDIR%\SoftwareDistribution\Download&quot;. Continuing with other Disk Cleanup tasks." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="true" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Command" value="del %WINDIR%\SoftwareDistribution\Download\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
              </Else>
            </If>
            <Statement description="Delete various vendors driver folders. Disabled in this example but can easily be enabled." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\dell&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="None">
              <Parameter xsi:type="StringParameter" name="Command" value="del c:\dell\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="None">
              <Parameter xsi:type="StringParameter" name="Command" value="rd c:\dell /S /Q" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\lenovo&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="None">
              <Parameter xsi:type="StringParameter" name="Command" value="del c:\lenovo\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="None">
              <Parameter xsi:type="StringParameter" name="Command" value="rd c:\lenovo /S /Q" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Remove files in  &quot;c:\hp&quot;" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="None">
              <Parameter xsi:type="StringParameter" name="Command" value="del c:\hp\* /q /s &gt;&gt;&gt;&gt;#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="None">
              <Parameter xsi:type="StringParameter" name="Command" value="rd c:\hp /S /Q" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: Post Disk Cleanup check for available disk space." name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="--------------------------------------------------------------" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="UPSTREAM: Disk Cleanup complete." />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="Disk available before Disk Cleanup on C: #free_disk_on_c#" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\sfk space c: &gt;&gt;#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="free_disk_on_c" />
            </Statement>
            <Statement name="GetFile" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="RemoteFileName" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
              <Parameter xsi:type="StringParameter" name="KServerFileName" value="..\Docs\free_disk_on_c.txt" />
              <Parameter xsi:type="EnumParameter" name="Action" value="SaveExistingNoAlert" />
            </Statement>
            <Statement name="Write text to file" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Parameter1" value="Disk available after Disk Cleanup on C: #free_disk_on_c#" />
              <Parameter xsi:type="StringParameter" name="Parameter2" value="#vAgentConfiguration.agentTempDir#\disk_cleanup.log" />
              <Parameter xsi:type="StringParameter" name="Parameter3" value="False" />
            </Statement>
            <Statement name="DeleteFile" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\free_disk_on_c.result" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: Status after Disk Cleanup: #free_disk_on_c#" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Disk Cleanup: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Enable RDP" treePres="3" id="1237272780" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="Description: This procedure will enable RDP for remote control.&#xA;&#xA;Kaseya customer value: This procedure enables RDP in the registry and enables RDP connections from Kaseya Live Connect. Security, support and control.&#xA;&#xA;End user value: Security, support and control.&#xA;&#xA;Dependencies: Windows.&#xA;&#xA;Usage: Execute the procedure at any time.&#xA;&#xA;Report options: Procedure Log, content: &quot;RDP is now enabled.&quot;&#xA; &#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot; No support included.">
            <Statement description="fDenyTSConnections set to 0 will enable RDP." name="SetRegistryValue" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="RegistryPath" value="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections" />
              <Parameter xsi:type="StringParameter" name="Value" value="0" />
              <Parameter xsi:type="EnumParameter" name="DataType" value="Integer" />
            </Statement>
            <Statement description="Writes a procedure log entry." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: RDP is now enabled." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Execute Shell Command - Interactive" treePres="3" id="279477562" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="Description: Run any shell command directly from the Kaseya Agent Procedure with interactive input. Great for testing ping or doing any command line related test on one or more machines at once.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Kaseya customer value: A quick way to test or do changes on one or many machines at once without having to enter LiveConnect or remote control.&#xA;&#xA;End user value: A quick way to get help with various tasks in system management.&#xA;&#xA;Usage: Execute the procedure at any time.&#xA;&#xA;Report Parameters: Procedure Log, &quot;Results from shell command:&quot;&#xA; &#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot; No support included.">
            <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="Prompt" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="Enter shell command to execute (example: ping www.kaseyea.com)" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="command" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false">
              <Parameter xsi:type="StringParameter" name="Command" value="#command# &gt;&gt; #vAgentConfiguration.agentTempDir#\command.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="PauseScript" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="IntegerParameter" name="Seconds" value="20" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\command.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="command-result" />
            </Statement>
            <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\command.result" />
            </Statement>
            <Statement description="Writes a procedure log for easy reporting." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Results from shell command: &quot;#command-result#&quot;" />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Get Latest File Example" treePres="3" id="92206681" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <If description="Procedure description: Transfer the most recent updated file in a folder to the Kaseya server.&#xD;&#xA;Kaseya customer value: Backup and audit purposes.&#xD;&#xA;End user value: Backup and audit purposes.&#xD;&#xA;Dependencies: Windows OS. Sfk.exe from Stahlworks.&#xD;&#xA;Usage: Schedule, Recurring or Run Now.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update or deployment statements.&#xD;&#xA;Maintainer: powerpack@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Check for missing dependencies.&#xD;&#xA;The IF statement below will look for existing trace of sfk.exe utility. Http://stahlworks.com/dev/swiss-file-knife.html">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\sfk.exe" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                <Parameter xsi:type="StringParameter" name="Value" value="" />
              </Condition>
              <Then>
                <Statement name="GetURL" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="URL" value="https://upstream.dattodrive.com/index.php/s/aUGgf7A4Vyv5dgR/download" />
                  <Parameter xsi:type="StringParameter" name="ResponseFileName" value="#vAgentConfiguration.agentTempDir#\sfk.exe" />
                  <Parameter xsi:type="BooleanParameter" name="WaitComplete" value="True" />
                </Statement>
              </Then>
            </If>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: File audit.&#xD;&#xA;Let's execute the application and put the resultin a text file. In this example we look at the root of the D: drive." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Command" value="#vAgentConfiguration.agentTempDir#\sfk.exe list -late=1 -nosub -quiet -relnames -pure d:\ &gt;&gt; #vAgentConfiguration.agentTempDir#\latestfile.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\latestfile.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="latestfile" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: #latestfile# identified as newst file. Preparing to upload file to Kaseya server." />
            </Statement>
            <Statement description="Let's do some house cleaning." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\latestfile.result" />
            </Statement>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: File transfer.&#xD;&#xA;Based on the findings in stage 2 we upload the latest file to the Kaseya server agent specific web folder.&#xD;&#xA;Example path on Kaseya server: &quot;d:\kaseya\userprofiles\&lt;agentid&gt;\getfiles\filetransfer\&quot;" name="GetFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="RemoteFileName" value="d:\#latestfile#" />
              <Parameter xsi:type="StringParameter" name="KServerFileName" value="FileTransfer\#latestfile#" />
              <Parameter xsi:type="EnumParameter" name="Action" value="OverwriteNoAlert" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: &quot;#latestfile#&quot; transfered successfully to the Kaseya server." />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Purge IIS Log Files Older Than 14 Days" treePres="3" id="743243966" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="Description: A simle automated task to delet log diles older than a 14 days in IIS Inetpub folder.&#xA;&#xA;Kaseya customer value: Procedure to automate a common managment task in IIS.&#xA;&#xA;End user value: Limiting the risk fo service interruptions and unwanted downtime.&#xA;&#xA;Dependencies: Windows OS.&#xA;&#xA;Usage: Run at any given time.&#xA;&#xA;Report options: Procedure Log, content: &quot;FindPSTFiles:*&quot;&#xA;&#xA;Script maintainer: ronny [at] upstream.se&#xA;&#xA;Support: This script is delivered &quot;as is&quot;. No support included.">
            <Statement description="This example will delete IIS log files older than 14 days on the first web site in Microsoft IIS Inetpub folder on the C: drive.&#xD;&#xA;Read more about the forfiles syntax here: http://technet.microsoft.com/en-us/library/cc753551.aspx" name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Command" value="forfiles /P &quot;C:\inetpub\logs\LogFiles\W3SVC1&quot; /S /M *.log /D -14 /C &quot;cmd /c del @path&quot;" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: ISS Inetpub cleanup on C:\inetpub\logs\LogFiles\W3SVC1\ executed." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Reboot If Kaseya Patch Mgmnt Reboot Pending Say Yes" treePres="3" id="1162398050" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Procedure description: Evaluates if reboot is pending after Kaseya Patch Mgmnt. Reboot immediately if true.&#xD;&#xA;Kaseya customer value:&#xD;&#xA;End user value:&#xD;&#xA;Dependencies: Windows OS. Recurring Patch Schedule with Kaseya.&#xD;&#xA;Usage: Schedule and only execute immediately.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Get the Pending Reboot SQL View Data from Kaseya database." name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="SQLView" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="vPatchStatusByAgent/rebootPending" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="RebootPending" />
            </Statement>
            <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: Reboot immediately if &quot;Reboot Pending&quot; flag is other than 0.&#xD;&#xA;The IF/ELSE statements below will look for &quot;Reboot Pending&quot; database value &quot;0&quot;.">
              <Condition name="CheckVariable">
                <Parameter xsi:type="StringParameter" name="VariableName" value="#RebootPending#" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                <Parameter xsi:type="StringParameter" name="Value" value="0" />
              </Condition>
              <Then>
                <If description="The IF/ELSE statements below will test &quot;Reboot Pending&quot; for any value but 0 a reboot will be shcduked immediately.">
                  <Condition name="CheckVariable">
                    <Parameter xsi:type="StringParameter" name="VariableName" value="#RebootPending#" />
                    <Parameter xsi:type="EnumParameter" name="Condition" value="NotEquals" />
                    <Parameter xsi:type="StringParameter" name="Value" value="0" />
                  </Condition>
                  <Then>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot required. Reboot Pending variable was: #RebootPending#" />
                    </Statement>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot scheduled to run NOW." />
                    </Statement>
                    <Statement name="Reboot" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008" />
                  </Then>
                  <Else>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: No reboot required. RebootPending variable was: #RebootPending#" />
                    </Statement>
                  </Else>
                </If>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot Pending variable was empty. Evaluate if Kaseya Automatic Patch is scheduled for the machine." />
                </Statement>
              </Else>
            </If>
            <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot Pending test procedure. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Restart Stopped Auto Services Except Blacklisted" treePres="3" id="1813435335" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Procedure description: Evaluate stopped Windows Services (except blacklisted) that are set to Auto-run and restart them.&#xD;&#xA;Kaseya customer value: Procedure to quickly log and repair stopped Windows Services marked as auto-run.&#xD;&#xA;End user value: Limiting the risk for unwanted downtime and disrutption of services.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Usage: Schedule, Recurring or Run Now. May replace &quot;*ALL&quot; Windows Services Monitor Set.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Let's evaluate if there are any Windows Services stopped (named Services excluded in a blacklist)." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 1: Auditing stopped Windows Services." />
            </Statement>
            <Statement description="The varibale below will set the blacklist for Services to be ignored. Add more Services if needed." name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="ConstantValue" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="and name!='airprint' and name!='sppsvc' and name!='clr_optimization_v4.0.30319_32' and name!='clr_optimization_v4.0.30319_64' and name!='gupdate' and name!='nvUpdatusService'" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="service_blacklist" />
            </Statement>
            <Statement description="Some Windows Services (such as sppsvc) are set as Auto but still Stopped.&#xD;&#xA;This can be a pain to monitor with *ALL Services Counter in Kaseya. This procedures may repalce that Monitor Set.&#xD;&#xA;The WMIC command below will look for Windows Services that are Auto, Stopped but not name!='XXX'. You can add more blacklisted Windows Servicses in the constant variable &quot;service_blacklist&quot; above." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Command" value="wmic service where &quot;startmode='auto' and state='stopped' #service_blacklist#&quot; get caption, name, startmode, state, exitcode &gt;&gt;#vAgentConfiguration.agentTempDir#\stopped_valid_services.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\stopped_valid_services.result &gt;&gt; #vAgentConfiguration.agentTempDir#\stopped_valid_services_utf.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\stopped_valid_services_utf.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="stopped_valid_services" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 1: Stopped Windows Services: #stopped_valid_services#" />
            </Statement>
            <Statement description="Let's do some cleanup." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\stopped_valid_services.result" />
            </Statement>
            <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\stopped_valid_services_utf.result" />
            </Statement>
            <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: If there are any stopped Windows Services (except blacklisted) we have to take action." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 2: Evaluating action for Stopped Services." />
            </Statement>
            <If description="">
              <Condition name="CheckVariable">
                <Parameter xsi:type="StringParameter" name="VariableName" value="#stopped_valid_services#" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                <Parameter xsi:type="StringParameter" name="Value" value="Caption" />
              </Condition>
              <Then>
                <Statement description="The WMIC command below will restart Windows Services that are Auto, Stopped but not name!='XXX'. You can add more blacklisted Windows Servicses in the list. Typically it's the same list as in stage 1 above." name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Command" value="wmic service where &quot;startmode='auto' and state='stopped' #service_blacklist#&quot; call startservice &gt;&gt;#vAgentConfiguration.agentTempDir#\restarted_valid_services.result" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\restarted_valid_services.result &gt;&gt;#vAgentConfiguration.agentTempDir#\restarted_valid_services_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                  <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\restarted_valid_services_utf.result" />
                  <Parameter xsi:type="StringParameter" name="VariableName" value="restarted_valid_services" />
                </Statement>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 2: Restarted Services: #restarted_valid_services#" />
                </Statement>
                <Statement description="Let's do some cleanup." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\restarted_valid_services.result" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\restarted_valid_services_utf.result" />
                </Statement>
                <Statement description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 3: Let's evaluate if there are any Windows Services stopped (named Services excluded in a blacklist) after above restart action." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 3: Auditing stopped Windows Services after restart attempt." />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Command" value="wmic service where &quot;startmode='auto' and state='stopped' #service_blacklist#&quot; get caption, name, startmode, state, exitcode &gt;&gt;#vAgentConfiguration.agentTempDir#\stopped_valid_services.result" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="ExecuteShellCommand" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\stopped_valid_services.result &gt;&gt; #vAgentConfiguration.agentTempDir#\stopped_valid_services_utf.result" />
                  <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                  <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                </Statement>
                <Statement name="GetVariable" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
                  <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\stopped_valid_services_utf.result" />
                  <Parameter xsi:type="StringParameter" name="VariableName" value="stopped_valid_services" />
                </Statement>
                <Statement description="Let's do some cleanup." name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\stopped_valid_services.result" />
                </Statement>
                <Statement name="DeleteFile" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\stopped_valid_services_utf.result" />
                </Statement>
                <If description="If any Windows Services (named Services not included in the blacklist) still isn't running we have to raise alert.">
                  <Condition name="CheckVariable">
                    <Parameter xsi:type="StringParameter" name="VariableName" value="#stopped_valid_services#" />
                    <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                    <Parameter xsi:type="StringParameter" name="Value" value="Caption" />
                  </Condition>
                  <Then>
                    <Statement description="Here you can raise alert or email if Service still isn't up after restart attempt." name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 3: One or more Windows Services still isn't running: #stopped_valid_services#" />
                    </Statement>
                  </Then>
                  <Else>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Stage 3: Restart attempt on stopped Services successful. No stopped Services (except blacklisted) detected." />
                    </Statement>
                  </Else>
                </If>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: Exiting: No Windows Services stopped. No action taken." />
                </Statement>
              </Else>
            </If>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="NT4|2000|XP|2003|Vista|2008">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Restart Services: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Send Message If Kaseya Patch Mgmnt Reboot Pending Say Yes" treePres="3" id="316998983" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Procedure description: Evaluates if reboot is pending after Kaseya Patch Mgmnt. Send custom message if true.&#xD;&#xA;Kaseya customer value:&#xD;&#xA;End user value:&#xD;&#xA;Dependencies: Windows OS. Recurring Patch Schedule with Kaseya.&#xD;&#xA;Usage: Recurring schedule.&#xD;&#xA;Report options: Agent Procedure log. Look for before, during and after update deployment statements.&#xD;&#xA;Maintainer: ronny@upstream.se&#xD;&#xA;------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 1: Get the Pending Reboot SQL View Data from Kaseya database." name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="SQLView" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="vPatchStatusByAgent/rebootPending" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="RebootPending" />
            </Statement>
            <If description="------------------------------------------------------------------------------------------------------------&#xD;&#xA;Stage 2: send message if &quot;Reboot Pending&quot; flag is other than 0.&#xD;&#xA;The IF/ELSE statements below will look for &quot;Reboot Pending&quot; database value &quot;0&quot;.">
              <Condition name="CheckVariable">
                <Parameter xsi:type="StringParameter" name="VariableName" value="#RebootPending#" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                <Parameter xsi:type="StringParameter" name="Value" value="0" />
              </Condition>
              <Then>
                <If description="The IF/ELSE statements below will test &quot;Reboot Pending&quot; for any value but 0 a reboot will be shcduked immediately.">
                  <Condition name="CheckVariable">
                    <Parameter xsi:type="StringParameter" name="VariableName" value="#RebootPending#" />
                    <Parameter xsi:type="EnumParameter" name="Condition" value="NotEquals" />
                    <Parameter xsi:type="StringParameter" name="Value" value="0" />
                  </Condition>
                  <Then>
                    <If description="">
                      <Condition name="UserIsLoggedIn">
                        <Parameter xsi:type="StringParameter" name="UserName" value="" />
                      </Condition>
                      <Then>
                        <Statement name="SendMessage" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Message" value="Enter message to be sent to user. Diplayed as popup." />
                          <Parameter xsi:type="BooleanParameter" name="Immediate" value="True" />
                        </Statement>
                        <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot required. Message sent to current user. Reboot Pending variable was: #RebootPending#" />
                        </Statement>
                      </Then>
                      <Else>
                        <Statement name="WriteScriptLogEntry" continueOnFail="false">
                          <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot required. No user logged in. No more action taken." />
                        </Statement>
                      </Else>
                    </If>
                  </Then>
                  <Else>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: No reboot required. RebootPending variable was: #RebootPending#" />
                    </Statement>
                  </Else>
                </If>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot Pending variable was empty. Evaluate if Kaseya Automatic Patch is scheduled for the machine." />
                </Statement>
              </Else>
            </If>
            <Statement description="This is a more human readable final notification in the Agent Procedure log." name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Reboot Pending test procedure. The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Set Data Execution Policy To Opt In" treePres="3" id="10241051" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Procedure description: Procedure to enable opt in for Data Execution Prevention. http://windowsitpro.com/systems-management/q-how-do-i-use-bcdedit-set-data-execution-prevention-dep-mode&#xD;&#xA;Kaseya customer value: Secure the OS.&#xD;&#xA;End user value: Secure the OS.&#xD;&#xA;Dependencies: Windows OS.&#xD;&#xA;Report options: Agent Procedure log. Look for &quot;UPSTREAM: Disk Cleanup:&quot; statements.&#xD;&#xA;Report options: Agent Procedure log.&#xD;&#xA;Maintainer: powerpack@upstream.se Latest update: 2017-08-28&#xD;&#xA;------------------------------------------------------------------------------------------------------------" name="ExecuteShellCommand" continueOnFail="false">
              <Parameter xsi:type="StringParameter" name="Command" value="wmic OS Get DataExecutionPrevention_SupportPolicy &gt;&gt;#vAgentConfiguration.agentTempDir#\dep_status.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="type #vAgentConfiguration.agentTempDir#\dep_status.result &gt;&gt; #vAgentConfiguration.agentTempDir#\dep_status_utf.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <Statement name="GetVariable" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="EnumParameter" name="VariableType" value="FileContent" />
              <Parameter xsi:type="StringParameter" name="SourceContent" value="#vAgentConfiguration.agentTempDir#\dep_status_utf.result" />
              <Parameter xsi:type="StringParameter" name="VariableName" value="GLOBAL:DEP_Value" />
            </Statement>
            <If description="">
              <Condition name="CheckVariable">
                <Parameter xsi:type="StringParameter" name="VariableName" value="#GLOBAL:DEP_Value#" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                <Parameter xsi:type="StringParameter" name="Value" value="2" />
              </Condition>
              <Then>
                <If description="">
                  <Condition name="TestFile">
                    <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\dep_status.result" />
                    <Parameter xsi:type="EnumParameter" name="Condition" value="DoesNotContain" />
                    <Parameter xsi:type="StringParameter" name="Value" value="2" />
                  </Condition>
                  <Then>
                    <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                      <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: DEP Opt In: DEP  value currently #GLOBAL:DEP_Value#" />
                    </Statement>
                    <If description="">
                      <Condition name="Windows 32 or 64 Bit Check">
                        <Parameter xsi:type="EnumParameter" name="Condition" value="Exists" />
                      </Condition>
                      <Then>
                        <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Command" value="bcdedit /set {current} nx OptIn" />
                          <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                          <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="True" />
                        </Statement>
                        <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: DEP Opt In: Setting DEP value to 2 (Opt In)." />
                        </Statement>
                      </Then>
                    </If>
                    <If description="">
                      <Condition name="Windows 32 or 64 Bit Check">
                        <Parameter xsi:type="EnumParameter" name="Condition" value="NotExists" />
                      </Condition>
                      <Then>
                        <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: DEP Opt In: Setting DEP value to 2 (Opt In)." />
                        </Statement>
                        <Statement name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Command" value="bcdedit /set {current} nx OptIn" />
                          <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
                          <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
                        </Statement>
                      </Then>
                    </If>
                  </Then>
                  <Else>
                    <If description="">
                      <Condition name="CheckVariable">
                        <Parameter xsi:type="StringParameter" name="VariableName" value="#GLOBAL:DEP_Value#" />
                        <Parameter xsi:type="EnumParameter" name="Condition" value="Equals" />
                        <Parameter xsi:type="StringParameter" name="Value" value="2" />
                      </Condition>
                      <Then>
                        <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                          <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: DEP Opt In: DEP correct. Current value: #global:cmdresults#" />
                        </Statement>
                      </Then>
                    </If>
                  </Else>
                </If>
              </Then>
            </If>
            <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\dep_status.result" />
            </Statement>
            <Statement name="DeleteFile" continueOnFail="true" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\dep_status_utf.result" />
            </Statement>
            <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: DEP Opt In: The Agent Procedure hit the last row and will now exit. Evaluate the Agent Procedure log output." />
            </Statement>
          </Body>
        </Procedure>
        <Procedure name="Sys Mgmnt - Windows - Test Pinging Internal Server" treePres="3" id="541791285" folderId="756998119809198" treeFullPath="Upstream Kaseya Power Pack.OS Patch and System Mgmnt 2018-10-26.Windows.System Management">
          <Body description="">
            <Statement description="Test if you have access to a specific internal server. Then you know you are inside the corporate network." name="ExecuteShellCommand" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Command" value="ping 192.168.0.102 &gt;&gt;#vAgentConfiguration.agentTempDir#\ping.result" />
              <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="User" />
              <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
            </Statement>
            <If description="">
              <Condition name="TestFile">
                <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ping.result" />
                <Parameter xsi:type="EnumParameter" name="Condition" value="Contains" />
                <Parameter xsi:type="StringParameter" name="Value" value="Lost = 4 (100% loss)," />
              </Condition>
              <Then>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: 100% Ping loss. Agent Procedure will not continue." />
                </Statement>
              </Then>
              <Else>
                <Statement name="WriteScriptLogEntry" continueOnFail="false" osType="Windows">
                  <Parameter xsi:type="StringParameter" name="Comment" value="UPSTREAM: Internal server reachable. Agent Procedure will continue." />
                </Statement>
              </Else>
            </If>
            <Statement description="Some house cleaning." name="DeleteFile" continueOnFail="false" osType="Windows">
              <Parameter xsi:type="StringParameter" name="Path" value="#vAgentConfiguration.agentTempDir#\ping.result" />
            </Statement>
          </Body>
        </Procedure>
      </Folder>
    </Folder>
  </Folder>
</ScriptExport>